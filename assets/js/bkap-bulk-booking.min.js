jQuery(document).ready((function($){$(".tstab-content").wrapInner('<div class="tstab-content-inner"></div>'),$(document).on("click",".tstab-tab",(function(){data_link=$(this).data("link"),cur_data_link=$(".tstab-tab.tstab-active").data("link"),cur_data_link!==data_link&&($(".tstab-content").removeClass("tstab-active").hide(),$("#"+data_link).addClass("tstab-active").css("position","relative").fadeIn("slow"),$(".tstab-tab").removeClass("tstab-active"),$(this).addClass("tstab-active"))})),jQuery("#bkap_clear_defaults").on("click",(function(){jQuery(this).text("Clearing...");jQuery.post(bkap_settings_params.ajax_url,{action:"bkap_clear_defaults"},(function(response){jQuery("#bulk_booking_update_notification").addClass("bkap_updated_notice"),jQuery("#bulk_booking_update_notification").css("display","block"),jQuery("#bulk_booking_update_notification").html("Default options are cleared.").fadeOut(1e4),window.location.reload()}))})),jQuery(".bkap-bulk-setting").on("click",(function(event){var save=!0,bkap_products=jQuery("#bkap_products").val();let bkap_defaults="";if(jQuery("#bkap_default_booking_option").prop("checked")&&(bkap_defaults=jQuery("#bkap_default_booking_option").val()),null!=bkap_products&&""!=bkap_products||(alert("Please select the products.."),save=!1),save){var data=bkap_save_product_settings();if(""!=data.blocks_enabled&&"false"==data.fixed_block_data)return!1;if(""!=data.ranges_enabled&&!data.price_range_data)return!1;if("error"in data)return alert(data.error),!1;data.product_id=bkap_products,data.all_product_ids=jQuery("#bkap_all_products").val(),data.bkap_defaults=bkap_defaults;var booking_options=JSON.parse(data.booking_options);""!=booking_options.booking_enable_date&&""!=booking_options.booking_type||(alert("Please enable booking setting and select booking type."),save=!1),save&&(jQuery("#woocommerce-booking").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),jQuery("#ajax_img").css("display","block"),jQuery(".bkap_execute_row_bulk").hide(),jQuery.post(bkap_settings_params.ajax_url,data,(function(response){jQuery(".bkap_execute_row_bulk").show(),jQuery("#bkap_products").val("").trigger("change"),jQuery("#woocommerce-booking").unblock(),jQuery("#ajax_img").css("display","none"),jQuery("#bulk_booking_update_notification").addClass("bkap_updated_notice"),jQuery("#bulk_booking_update_notification").css("display","block"),jQuery("#bulk_booking_update_notification").html("Settings Saved.").fadeOut(1e4),window.location.reload()})))}})),jQuery(".bkap_bulk_products").select2({width:"75%",placeholder:"Select products.."}),$("#bulk_setting_availability_rows").on("change","#bkap_bulk_day_date",(function(){var value=$(this).val(),row=$(this).closest("tr");$(row).find(".bkap_bulk_date, .bkap_bulk_day_div").hide(),"day"==value&&$(row).find(".bkap_bulk_day_div").show(),"date"==value&&$(row).find(".bkap_bulk_date").show()})),$("body").on("bkap_bulk_row_added",(function(){$("#bkap_bulk_day_date").change()})),$(".bkap_add_row_bulk").click((function(e){var each_row=new Array,i=0;if(jQuery("tr[class^='bkap_bulk_booking_setting_row']").each((function(){var class_name_row=jQuery(this)[0].className;class_name_row;var res=class_name_row.replace("bkap_bulk_booking_setting_row_","");res==class_name_row&&0==each_row.length?each_row[i]=1:each_row[i]=parseInt(res),i++})),0==each_row.length)new_id=0;else var new_id=Math.max.apply(Math,each_row)+1;var newRow=$(this).data("row");newRow=(newRow=(newRow=newRow.replace("bkap_bulk_booking_setting_row","bkap_bulk_booking_setting_row_"+new_id)).replace("bkap_bulk_date_field","bkap_bulk_date_field_"+new_id)).replace("bkap_bulk_weekday","bkap_bulk_weekday_"+new_id),$(this).closest("table").find("tbody").append(newRow);return jQuery("#bkap_bulk_weekday_"+new_id).select2({placeholder:"Select days.."}),jQuery("#bkap_bulk_date_field_"+new_id).datepick({minDate:new Date,dateFormat:"d-m-yyyy",multiSelect:999,monthsToShow:1,showTrigger:"#calImg"}),$("body").trigger("bkap_bulk_row_added"),!1})),jQuery("#bulk_setting_availability_rows").on("click","#bkap_close_bulk_row",(function(e){$(this).parent().remove()})),function bkap_bulk_booking_settings_trigger_change_events(){$("#bkap_bulk_day_date").change()}(),jQuery(document).on("click",".bkap_execute_row_bulk",(function(e){var bkap_executable_products=jQuery("#bkap_executable_products").val();if(null!=bkap_executable_products&&""!=bkap_executable_products){var j=0,execution_data={},validated=!0;if(jQuery('tr[class^="bkap_bulk_booking_setting_row"]').each((function(i,row){jQuery(this).removeClass("bkap_error");var daydate=jQuery(this).find('select[id^="bkap_bulk_day_date"]').val(),daydate_value="";switch(daydate){case"day":daydate_value=jQuery(this).find('select[id^="bkap_bulk_weekday_"]').val();break;case"date":daydate_value=jQuery(this).find('textarea[class^="date-picker"]').val()}execution_data[j]={},execution_data[j].bulk_day_date=daydate,execution_data[j].bulk_day_date_value=daydate_value,execution_data[j].bulk_action=jQuery(this).find('select[id^="bkap_bulk_action"]').val(),execution_data[j].bulk_from_time=jQuery(this).find('input[id^="bkap_bulk_from_time"]').val(),execution_data[j].bulk_to_time=jQuery(this).find('input[id^="bkap_bulk_to_time"]').val(),execution_data[j].bulk_lockout_slot=jQuery(this).find('input[id^="bkap_bulk_max_booking"]').val(),execution_data[j].bulk_slot_price=jQuery(this).find('input[id^="bkap_bulk_price"]').val(),execution_data[j].bulk_note=jQuery(this).find('textarea[id^="bkap_bulk_note"]').val(),j++,""!=daydate_value&&null!=daydate_value||(jQuery(this).addClass("bkap_error"),validated=!1)})),jQuery.isEmptyObject(execution_data))alert("Please add action to execute it.");else{if(!validated)return jQuery("#execute_booking_update_notification").css("display","block"),jQuery("#execute_booking_update_notification").html('<b style="color:red;">Please fillout all fields.</b>').fadeOut(5e3),!1;jQuery(".bkap-executable-table").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),jQuery(".bkap_execute_row_bulk #ajax_img").css("display","block");var bkap_all_bookable_products=jQuery("#bkap_all_bookable_products").val(),data={bulk_execution_data:JSON.stringify(execution_data),bkap_selected_product:bkap_executable_products,bkap_all_bookable_products:bkap_all_bookable_products,action:"bkap_execute_data"};jQuery(".bkap-bulk-setting").hide(),jQuery.post(bkap_settings_params.ajax_url,data,(function(response){jQuery(".bkap-bulk-setting").show(),jQuery("#bulk_setting_availability_rows").empty(),jQuery("#bkap_executable_products").val("").trigger("change"),jQuery(".bkap-executable-table").unblock(),jQuery(".bkap_execute_row_bulk #ajax_img").css("display","none"),jQuery("#execute_booking_update_notification").css("display","block"),jQuery("#execute_booking_update_notification").html("<b>"+response+"</b>").fadeOut(1e4)}))}}else alert("Please select the products..")}));var tipText="";$(".woocommerce-help-tip").each((function(i,el){tipText=el.getAttribute("data-tip"),el.removeAttribute("data-tip"),el.setAttribute("title",tipText)}))}));
