var time_slot={row_number:0,booking_weekday:"",from_time:"",to_time:"",max_lockout:"",global_time_check:"",global_toggle_btn:!1,product_price:"",additional_note:""};function bkap_field_validation(field,bkap_compare_value,bkap_field_name=""){let bkap_field_value=0;""!=field.value&&(bkap_field_value=parseInt(field.value)),bkap_field_value<bkap_compare_value&&(alert(bkap_field_name+" can not be less than "+bkap_compare_value+"!"),field.value=bkap_compare_value)}function append_weekdays(){jQuery("#set_weekdays").on("click",'[id^="booking_weekday_"]',(function(){var id=this.id,name=this.name;jQuery("#"+id).prop("checked")?(jQuery('#bkap_date_timeslot_table tr[id="bkap_default_date_time_row"]').each((function(i,row){jQuery("#bkap_dateday_selector").append('<option value="'+id+'">'+name+"</option>")})),jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').each((function(i,row){var element_id=jQuery(this).find('select[id^="bkap_dateday_selector_"]').prop("id");(element_id="#"+element_id,jQuery(this).is(":visible"))?jQuery(element_id).append('<option value="'+id+'">'+name+"</option>"):jQuery(element_id).val()==id?jQuery(this).toggle():jQuery(element_id).append('<option value="'+id+'">'+name+"</option>")}))):(jQuery('#bkap_date_timeslot_table tr[id="bkap_default_date_time_row"]').each((function(i,row){jQuery('#bkap_dateday_selector option[value="'+id+'"]').remove()})),jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').each((function(i,row){var element_id=jQuery(this).find('select[id^="bkap_dateday_selector_"]').prop("id");(element_id="#"+element_id,jQuery(element_id).val()==id)?jQuery(this).hide():jQuery(element_id+' option[value="'+id+'"]').remove()})))}))}function append_specific_dates(id,value){if(null!=id&&null!=value){var row_number=id.split("_")[3];if("specific_dates"==jQuery("#range_dropdown_"+row_number).val()){if(""!=value)value.split(",").forEach((function(date){jQuery('#bkap_date_timeslot_table tr[id="bkap_default_date_time_row"]').each((function(i,row){jQuery("#bkap_dateday_selector").append('<option value="'+date+'">'+date+"</option>")})),jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').each((function(i,row){var element_id=jQuery(this).find('select[id^="bkap_dateday_selector_"]').prop("id");element_id="#"+element_id,0==jQuery(element_id+" option[value='"+date+"']").length&&jQuery(element_id).append('<option value="'+date+'">'+date+"</option>")}))}));var all_specific_datess="";if(jQuery('.specific tr[class^="added_specific_date_range_row_"]').each((function(i,row){jQuery(this).find('select[id^="range_dropdown"]').val();var specific_dates_each_row=jQuery(this).find('textarea[id*="specific_dates_multidatepicker"]').val();""!=specific_dates_each_row&&(all_specific_datess+=","+specific_dates_each_row)})),""!=all_specific_datess){var all_specific_datess_array=all_specific_datess.split(",");all_specific_datess_array.slice(1);var all_dates_in_select2_option=[];jQuery("#bkap_dateday_selector > option").each((function(){var value=this.innerHTML;isNaN(value.charAt(0))||all_dates_in_select2_option.push(value)})),all_dates_in_select2_option.forEach((function(date1){-1==jQuery.inArray(date1,all_specific_datess_array)&&(jQuery('#bkap_date_timeslot_table tr[id="bkap_default_date_time_row"]').each((function(i,row){jQuery("#bkap_dateday_selector").find('option[value="'+date1+'"]').remove()})),jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row"]').each((function(i,row){var element_id=jQuery(this).find('select[id^="bkap_dateday_selector_"]').prop("id");element_id="#"+element_id,jQuery(element_id).find('option[value="'+date1+'"]').remove()})))}))}}}}function bkap_add_weekdays(){jQuery("#set_weekdays").css("display","block"),jQuery(".weekdays_flex_child_3").css("display","none")}function bkap_isNumberKey(evt){var charCode=evt.which?evt.which:evt.keyCode;return(1!=evt.target.value.length||2!=evt.target.value||-1!=[48,49,50,51].indexOf(charCode))&&((0!=evt.target.value.length||-1!=[48,49,50].indexOf(charCode))&&((3!=evt.target.value.length||-1!=[48,49,50,51,52,53].indexOf(charCode))&&((0!=evt.target.value.length&&1!=evt.target.value.length&&3!=evt.target.value.length&&4!=evt.target.value.length||58!=charCode)&&((2!=evt.target.value.length||58==charCode)&&!(charCode>31&&(charCode<48||charCode>57)&&58!=charCode)))))}function bkap_add_weekdays_avail(){jQuery("#set_weekdays").css("display","block"),jQuery(".weekdays_flex_child_3").css("display","block")}function bkap_get_general_tab_data(){var booking_options={};jQuery("#booking_enable_date").prop("checked")?booking_options.booking_enable_date=jQuery("#booking_enable_date").val():booking_options.booking_enable_date="";var booking_type=jQuery("#bkap-booking-type").val();booking_options.booking_type=booking_type,"function"==typeof booking_options_additional&&(booking_options=booking_options_additional(booking_options));let multidates_type=jQuery("#bkap_multidates_fixed_range").val(),multidates_fixed_number=jQuery("#bkap_multidates_fixed_number").val(),multidates_range_min=jQuery("#bkap_multidates_range_min").val(),multidates_range_max=jQuery("#bkap_multidates_range_max").val();return booking_options.multidates_type=multidates_type,booking_options.multidates_fixed_number=multidates_fixed_number,booking_options.multidates_range_min=multidates_range_min,booking_options.multidates_range_max=multidates_range_max,jQuery("#enable_inline_calendar").prop("checked")?booking_options.enable_inline=jQuery("#enable_inline_calendar").val():booking_options.enable_inline="",jQuery("#booking_purchase_without_date").prop("checked")?booking_options.purchase_wo_date=jQuery("#booking_purchase_without_date").val():booking_options.purchase_wo_date="",jQuery("#bkap_requires_confirmation").prop("checked")?booking_options.requires_confirmation=jQuery("#bkap_requires_confirmation").val():booking_options.requires_confirmation="",booking_options.can_be_cancelled={},jQuery("#bkap_can_be_cancelled").prop("checked")&&(booking_options.can_be_cancelled.status=jQuery("#bkap_can_be_cancelled").val(),booking_options.can_be_cancelled.duration=jQuery("#bkap_can_be_cancelled_duration").val(),booking_options.can_be_cancelled.period=jQuery("#bkap_can_be_cancelled_period").val()),jQuery("#wkpbk_block_single_week").prop("checked")?(booking_options.wkpbk_block_single_week=jQuery("#wkpbk_block_single_week").val(),booking_options.special_booking_start_weekday=jQuery("#special_booking_start_weekday").val(),booking_options.special_booking_end_weekday=jQuery("#special_booking_end_weekday").val()):(booking_options.wkpbk_block_single_week="",booking_options.special_booking_start_weekday="",booking_options.special_booking_end_weekday=""),jQuery("#bkap_date_in_dropdown").prop("checked")?booking_options.bkap_date_in_dropdown=jQuery("#bkap_date_in_dropdown").val():booking_options.bkap_date_in_dropdown="",jQuery("#bkap_customer_has_booking").prop("checked")?booking_options.bkap_customer_has_booking=jQuery("#bkap_customer_has_booking").val():booking_options.bkap_customer_has_booking="",booking_options}function bkap_get_only_day_type(){var only_day_type=jQuery("input:radio[name=booking_enable_only_day]:checked").val(),booking_type="only_day";return null!=only_day_type&&("booking_enable_single_day"==only_day_type.trim()?booking_type="only_day":"booking_enable_multiple_days"==only_day_type.trim()&&(booking_type="multiple_days")),booking_type}function bkap_get_date_and_time_type(){var date_time_type=jQuery("input:radio[name=booking_enable_date_time]:checked").val();return booking_type="date_time",null!=date_time_type&&("booking_enable_fixed_time"==date_time_type.trim()?booking_type="date_time":"booking_enable_duration_time"==date_time_type.trim()&&(booking_type="duration_time")),booking_type}function bkap_save_booking_options(){bkap_hide_save_icon("bkap_save_booking_options"),booking_options=bkap_get_general_tab_data();var data={booking_options:JSON.stringify(booking_options),product_id:bkap_settings_params.post_id,action:"bkap_save_settings"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){bkap_show_save_icon("bkap_save_booking_options"),jQuery("#general_update_notification").addClass("bkap_updated_notice"),jQuery("#general_update_notification").css("display","block"),jQuery("#general_update_notification").html(bkap_settings_params.general_update_msg).fadeOut(3e3)}))}function bkap_save_resources(){bkap_hide_save_icon("bkap_save_resources"),resource_data=bkap_resource_data();var data={resource_data:JSON.stringify(resource_data),product_id:bkap_settings_params.post_id,action:"bkap_save_settings"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){bkap_show_save_icon("bkap_save_resources"),jQuery("#resource_update_notification").addClass("bkap_updated_notice"),jQuery("#resource_update_notification").css("display","block"),jQuery("#resource_update_notification").html(bkap_settings_params.resource_update_msg).fadeOut(3e3)}))}function bkap_save_person(){bkap_hide_save_icon("bkap_save_person"),person_data=bkap_person_data();var data={person_data:JSON.stringify(person_data),product_id:bkap_settings_params.post_id,action:"bkap_save_settings"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){bkap_show_save_icon("bkap_save_person"),jQuery("#person_update_notification").addClass("bkap_updated_notice"),jQuery("#person_update_notification").css("display","block"),jQuery("#person_update_notification").html(bkap_settings_params.person_update_msg).fadeOut(1e4)}))}jQuery(document).on("click","#test_connection",(function(e){e.preventDefault();var data={gcal_api_test_result:"",gcal_api_pre_test:"",gcal_api_test:1,user_id:bkap_settings_params.user_id,product_id:bkap_settings_params.post_id,action:"display_nag"};jQuery("#test_connection_ajax_loader").show(),jQuery.post(bkap_settings_params.ajax_url,data,(function(response){jQuery("#test_connection_message").html(response),jQuery("#test_connection_ajax_loader").hide()}))})),jQuery(document).on("click","#add_new_ics_feed",(function(){var rowCount=parseInt(jQuery("#product_ics_feed_list tr:last").prop("id"))+1;isNaN(parseInt(rowCount))&&(rowCount=0),jQuery("#product_ics_feed_list").append("<tr id='"+rowCount+"'><th></th><td class='ics_feed_url'><input type='text' id='product_ics_fee_url_"+rowCount+"' name='product_ics_fee_url_"+rowCount+"' size='40' value=''></td></tr>")})),jQuery(document).on("click","input[type='button'][name='delete_ics_feed']",(function(){var key=jQuery(this).prop("id"),data={ics_feed_key:key,product_id:bkap_settings_params.post_id,action:"bkap_delete_ics_url_feed"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){"yes"==response&&jQuery("table#product_ics_feed_list tr#"+key).remove()}))})),jQuery(document).on("click","input[type='button'][name='import_ics']",(function(){jQuery("#import_event_message").show();var data={ics_feed_key:jQuery(this).prop("id"),product_id:bkap_settings_params.post_id,action:"bkap_import_events"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){jQuery("#import_event_message").hide(),jQuery("#success_message").html(response),jQuery("#success_message").fadeIn(),setTimeout((function(){jQuery("#success_message").fadeOut()}),3e3)}))})),jQuery(document).on("click","#enable_automated_mapping",(function(){jQuery("#enable_automated_mapping").prop("checked")?jQuery("#gcal_default_variation").prop("disabled",!1):jQuery("#gcal_default_variation").prop("disabled",!0)}));var a,acc=document.getElementsByClassName("bkap-integrations-accordion");for(a=0;a<acc.length;a++)acc[a].addEventListener("click",(function(){this.classList.toggle("bkap-accordion-active");var panel=this.nextElementSibling;"block"===panel.style.display?panel.style.display="none":panel.style.display="block"}));function bkap_get_availability_data(){var settings_data={};settings_data.abp=jQuery("#booking_minimum_number_days").val(),settings_data.max_bookable=jQuery("#booking_maximum_number_days").val(),jQuery("#booking_lockout_date").length>0&&(settings_data.date_lockout=jQuery("#booking_lockout_date").val()),jQuery("#booking_minimum_number_days_multiple").length>0&&(settings_data.min_days_multiple=jQuery("#booking_minimum_number_days_multiple").val()),jQuery("#booking_maximum_number_days_multiple").length>0&&(settings_data.max_days_multiple=jQuery("#booking_maximum_number_days_multiple").val());var all_weekdays=jQuery('*[id^="booking_weekday_"]'),all_lockout=jQuery('*[id^="weekday_lockout_"]'),all_price=jQuery('*[id^="weekday_price_"]');for(i=0;i<=6;i++){var weekday_name="booking_weekday_"+i;jQuery(all_weekdays[i]).prop("checked")?settings_data[weekday_name]=jQuery(all_weekdays[i]).val():settings_data[weekday_name]="",settings_data["weekday_lockout_"+i]=jQuery(all_lockout[i]).val(),settings_data["weekday_price_"+i]=jQuery(all_price[i]).val()}var custom_range="",specific_dates_list="",range_months="",holidays_list="",holiday_range="";jQuery("#specific_date_checkbox").prop("checked")?settings_data.enable_specific=jQuery("#specific_date_checkbox").val():settings_data.enable_specific="",jQuery('.specific tr[class^="added_specific_date_range_row_"]').each((function(i,row){var range_set=jQuery(this).find('select[id^="range_dropdown"]').val();switch(range_set){case"custom_range":var custom_start=jQuery(this).find('input[class*="datepicker_start_date"]').val(),custom_end=jQuery(this).find('input[class*="datepicker_end_date"]').val();if(jQuery(this).find('input[id*="bkap_bookable_nonbookable"]').prop("checked"))var booking_status="on";else booking_status="";var recur_years=jQuery(this).find('input[id*="bkap_number_of_year_to_recur_custom_range"]').val();"on"==booking_status?custom_range+=custom_start+"+"+custom_end+"+"+recur_years+";":holiday_range+=custom_start+"+"+custom_end+"+"+recur_years+"+"+range_set+";";break;case"specific_dates":var specific_dates=jQuery(this).find('textarea[id*="specific_dates_multidatepicker"]').val();if(jQuery(this).find('input[id*="bkap_bookable_nonbookable"]').prop("checked"))booking_status="on";else booking_status="";var lockout=jQuery(this).find('input[id*="bkap_specific_date_lockout"]').val(),price=jQuery(this).find('input[id*="bkap_specific_date_price"]').val();"on"==booking_status?specific_dates_list+=specific_dates+"+"+lockout+"+"+price+";":holidays_list+=specific_dates+"+"+range_set+";";break;case"range_of_months":custom_start=jQuery(this).find('select[id*="bkap_availability_from_month"]').val(),custom_end=jQuery(this).find('select[id*="bkap_availability_to_month"]').val();if(jQuery(this).find('input[id*="bkap_bookable_nonbookable"]').prop("checked"))booking_status="on";else booking_status="";recur_years=jQuery(this).find('input[id*="bkap_number_of_year_to_recur_month"]').val();"on"==booking_status?range_months+=custom_start+"+"+custom_end+"+"+recur_years+";":holiday_range+=custom_start+"+"+custom_end+"+"+recur_years+"+"+range_set+";";break;case"holidays":var holidays=jQuery(this).find('textarea[id*="holidays_multidatepicker"]').val();if(jQuery(this).find('input[id*="bkap_bookable_nonbookable"]').prop("checked"))booking_status="on";else booking_status="";recur_years=jQuery(this).find('input[id*="bkap_number_of_year_to_recur_holiday"]').val();"on"==booking_status?specific_dates_list+=holidays+"+0;":holidays_list+=holidays+"+"+recur_years+"+"+range_set+";"}})),settings_data.holidays_list=holidays_list,settings_data.specific_list=specific_dates_list,settings_data.month_range=range_months,settings_data.custom_range=custom_range,settings_data.holiday_range=holiday_range,jQuery("#bkap_list_until_end_time").prop("checked")?settings_data.bkap_list_until_end_time=jQuery("#bkap_list_until_end_time").val():settings_data.bkap_list_until_end_time="";var booking_times={},time_type=jQuery("#bkap-booking-type").val(),j=0,datetimecheck=!0;if(jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').each((function(i,row){var selector=jQuery(this).find('select[id^="bkap_dateday_selector_"]').val(),bkap_from_time=jQuery(this).find('input[id^="bkap_from_time_"]').val();if(jQuery(this).find('a[id^="bkap_save_timeslot_"]').length>0){bkap_save_edited_timeslot(this.id.split("_")[4],(function(response){}))}""!=selector&&null!=selector&&""!=bkap_from_time&&null!=bkap_from_time||(datetimecheck=!1),booking_times[j]={},booking_times[j].day=selector,booking_times[j].from_time=jQuery(this).find('input[id^="bkap_from_time_"]').val(),booking_times[j].to_time=jQuery(this).find('input[id^="bkap_to_time_"]').val(),booking_times[j].lockout_slot=jQuery(this).find('input[id^="bkap_lockout_time_"]').val(),booking_times[j].slot_price=jQuery(this).find('input[id^="bkap_price_time_"]').val();var global_check="";jQuery(this).find('input[id*="bkap_global_time"]').prop("checked")&&(global_check="on"),booking_times[j].global_time_check=global_check,booking_times[j].booking_notes=jQuery(this).find('textarea[id^="bkap_note_time_"]').val(),j++})),!datetimecheck)return{error:"datetime"};jQuery(".bkap_date_timeslot_div").trigger("bkap_added"),jQuery(".bkap_date_timeslot_div").trigger("bkap_row_updated");var bkap_data_toolbar=jQuery(".bkap_date_timeslot_div").find(".bkap_toolbar");if(null!=bkap_data_toolbar.data("time-slots")){var bkap_time_slots=bkap_data_toolbar.attr("data-time-slots"),bkap_time_slots_parsing=JSON.parse(bkap_time_slots);Object.keys(bkap_time_slots_parsing).length>0&&(booking_times=bkap_time_slots_parsing)}settings_data.booking_times=booking_times,"function"==typeof bkapdt_settings_data&&(settings_data=bkapdt_settings_data(settings_data));var duration_times={},duration=duration_min=duration_max=1,duration_gap=0;return""!=jQuery("#bkap_duration").val()&&(duration=parseInt(jQuery("#bkap_duration").val())),""!=jQuery("#bkap_duration_gap").val()&&(duration_gap=parseInt(jQuery("#bkap_duration_gap").val())),""!=jQuery("#bkap_duration_min").val()&&(duration_min=parseInt(jQuery("#bkap_duration_min").val())),""!=jQuery("#bkap_duration_max").val()&&(duration_max=parseInt(jQuery("#bkap_duration_max").val())),duration_times.duration_label=jQuery("#bkap_duration_label").val(),duration_times.duration=duration,duration_times.duration_gap=duration_gap,duration_times.duration_min=duration_min,duration_times.duration_max=duration_max,duration_times.duration_max_booking=parseInt(jQuery("#bkap_duration_max_booking").val()),duration_times.duration_price=jQuery("#bkap_duration_price").val(),duration_times.first_duration=jQuery("#bkap_duration_start").val(),duration_times.end_duration=jQuery("#bkap_duration_end").val(),jQuery("#bkap_duration_type").length>0&&(duration_times.duration_type=jQuery("#bkap_duration_type").val()),jQuery("#bkap_duration_gap_type").length>0&&(duration_times.duration_gap_type=jQuery("#bkap_duration_gap_type").val()),settings_data.duration_times=duration_times,"date_time"!=time_type&&"multidates_fixedtime"!=time_type&&"duration_time"!=time_type||(jQuery("#bkap_all_data_unavailable").prop("checked")?settings_data.all_data_unavailable=jQuery("#bkap_all_data_unavailable").val():settings_data.all_data_unavailable="",settings_data.manage_time_availability=bkap_mta_data()),settings_data}function bkap_mta_data(){let bkap_mta=[];return jQuery("#bkap_availability_rows tr").each((function(i,row){let bkap_mta_type=jQuery(this).find('select[name^="bkap_availability_type"]').val(),bkap_mta_bookable=jQuery(this).find('input[name^="bkap_availability_bookable_hidden"]').val(),bkap_mta_priority=jQuery(this).find('input[name^="bkap_availability_priority"]').val(),bkap_mta_from_date=jQuery(this).find('input[name^="bkap_availability_from_date"]').val(),bkap_mta_to_date=jQuery(this).find('input[name^="bkap_availability_to_date"]').val();switch(bkap_mta[i]={},bkap_mta[i].type=bkap_mta_type,bkap_mta[i].bookable=bkap_mta_bookable,bkap_mta[i].priority=bkap_mta_priority,bkap_mta_type){case"custom":bkap_mta[i].from=bkap_mta_from_date,bkap_mta[i].to=bkap_mta_to_date;break;case"months":bkap_mta[i].from=jQuery(this).find('select[name^="bkap_availability_from_month"]').val(),bkap_mta[i].to=jQuery(this).find('select[name^="bkap_availability_to_month"]').val();break;case"weeks":bkap_mta[i].from=jQuery(this).find('select[name^="bkap_availability_from_week"]').val(),bkap_mta[i].to=jQuery(this).find('select[name^="bkap_availability_to_week"]').val();break;case"days":bkap_mta[i].from=jQuery(this).find('select[name^="bkap_availability_from_day_of_week"]').val(),bkap_mta[i].to=jQuery(this).find('select[name^="bkap_availability_to_day_of_week"]').val();break;case"time":case"time:1":case"time:2":case"time:3":case"time:4":case"time:5":case"time:6":case"time:0":bkap_mta[i].from=jQuery(this).find('input[name^="bkap_availability_from_time"]').val(),bkap_mta[i].to=jQuery(this).find('input[name^="bkap_availability_to_time"]').val();break;case"time:range":bkap_mta[i].from=jQuery(this).find('input[name^="bkap_availability_from_time"]').val(),bkap_mta[i].to=jQuery(this).find('input[name^="bkap_availability_to_time"]').val(),bkap_mta[i].from_date=bkap_mta_from_date,bkap_mta[i].to_date=bkap_mta_to_date}})),bkap_mta}function bkap_save_product_settings(){booking_options=bkap_get_general_tab_data(),settings_data=bkap_get_availability_data(),gcal_settings=bkap_get_gcal_data(),fixed_block_data=bkap_fixed_block_data(),price_range_data=bkap_price_range_data(),resource_data=bkap_resource_data(),person_data=bkap_person_data();var error={};"error"in settings_data&&(error={error:bkap_settings_params.error_input_field_msg});var fixed_blocks_enable="",price_ranges_enable="",block_price="";return null!=(block_price=jQuery("input:radio[name=bkap_enable_block_pricing_type]:checked").val())&&(block_price.length>0&&"booking_block_price_enable"==block_price&&(price_ranges_enable=block_price),block_price.length>0&&"booking_fixed_block_enable"==block_price&&(fixed_blocks_enable=block_price)),"error"in error?error:{booking_options:JSON.stringify(booking_options),settings_data:JSON.stringify(settings_data),gcal_data:JSON.stringify(gcal_settings),ranges_enabled:price_ranges_enable,blocks_enabled:fixed_blocks_enable,fixed_block_data:JSON.stringify(fixed_block_data),price_range_data:price_range_data,resource_data:JSON.stringify(resource_data),person_data:JSON.stringify(person_data),product_id:bkap_settings_params.post_id,action:"bkap_save_settings"}}function bkap_save_settings(){bkap_hide_save_icon("bkap_save_settings");let validation=do_bkap_save_settings_validation();if(validation.isNotValidated)return alert(validation.alertMessage),void bkap_show_save_icon("bkap_save_settings");if(settings_data=bkap_get_availability_data(),"error"in settings_data)jQuery("#availability_update_notification").addClass("bkap_error_notice"),jQuery("#availability_update_notification").css("display","block"),jQuery("#availability_update_notification").html(bkap_settings_params.error_input_field_msg).fadeOut(1e4);else{var data={settings_data:JSON.stringify(settings_data),product_id:bkap_settings_params.post_id,action:"bkap_save_settings"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){0!=jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').length&&jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').each((function(i,row){var from_id=jQuery(this).find('input[id^="bkap_from_time_"]').prop("id");from_id="#"+from_id,jQuery(from_id).attr("readonly","readonly");var to_id=jQuery(this).find('input[id^="bkap_to_time_"]').prop("id");to_id="#"+to_id,jQuery(to_id).attr("readonly","readonly");var datedate_select=jQuery(this).find('[id^="bkap_dateday_selector_"]').prop("id");datedate_select_id="#"+datedate_select,jQuery(datedate_select_id).prop("disabled","disabled")})),bkap_show_save_icon("bkap_save_settings"),jQuery("#availability_update_notification").addClass("bkap_updated_notice"),jQuery("#availability_update_notification").css("display","block"),jQuery("#availability_update_notification").html(bkap_settings_params.availability_update_msg).fadeOut(3e3)}))}}function bkap_save_fixed_block_settings(){var fixed_blocks_enable="",block_price=jQuery("input:radio[name=bkap_enable_block_pricing_type]:checked").val();if(jQuery(".bkap_fixed_block_booking").removeClass("bkap_disable_block_pricing"),jQuery(".bkap_fixed_block_booking").show(),jQuery(".bkap_price_range_booking").hide(),block_price.length>0&&"booking_fixed_block_enable"==block_price&&(fixed_blocks_enable=block_price),0!=bkap_settings_params.post_id){var data={blocks_enabled:fixed_blocks_enable,product_id:bkap_settings_params.post_id,action:"bkap_save_settings"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){}))}}function bkap_save_fixed_blocks(){var fixed_block_data=bkap_fixed_block_data();if(!fixed_block_data)return!1;var data={fixed_block_data:JSON.stringify(fixed_block_data),product_id:bkap_settings_params.post_id,action:"bkap_save_settings"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){jQuery("#block_pricing_update_notification").addClass("bkap_updated_notice"),jQuery("#block_pricing_update_notification").css("display","block"),jQuery("#block_pricing_update_notification").html(bkap_block_pricing_params.save_fixed_blocks).fadeOut(1e4)}))}function bkap_fixed_block_data(){var fixed_block_data={},fixed_block_row_data="",validate_field="";return jQuery('#bkap_fixed_block_booking_table tr[id^="bkap_fixed_block_row_"]').each((function(i,row){var block_name=jQuery(this).find('input[id*="booking_block_name"]').val(),number_of_days=jQuery(this).find('input[id*="number_of_days"]').val(),start_day=jQuery(this).find('select[id*="start_day"]').val(),end_day=jQuery(this).find('select[id*="end_day"]').val(),price=jQuery(this).find('input[id*="fixed_block_price"]').val(),fixed_block_row_id_number=this.id.split("_")[4];return""==block_name?(alert("Block name must be filled out"),validate_field="FAILED",!1):""==number_of_days?(alert("Number of days must be filled out"),validate_field="FAILED",!1):""==price?(alert("Price must be filled out"),validate_field="FAILED",!1):void(fixed_block_row_data+=block_name+"&&"+number_of_days+"&&"+start_day+"&&"+end_day+"&&"+price+"&&"+fixed_block_row_id_number+";")})),fixed_block_data.bkap_fixed_block_data=fixed_block_row_data,"FAILED"!=validate_field&&fixed_block_data}function bkap_save_price_ranges(){var price_range_data=bkap_price_range_data();if(!price_range_data)return!1;var data={price_range_data:price_range_data,product_id:bkap_settings_params.post_id,action:"bkap_save_settings"};0!=bkap_settings_params.post_id&&jQuery.post(bkap_settings_params.ajax_url,data,(function(response){jQuery("#block_pricing_update_notification").addClass("bkap_updated_notice"),jQuery("#block_pricing_update_notification").css("display","block"),jQuery("#block_pricing_update_notification").html(bkap_block_pricing_params.save_price_ranges).fadeOut(1e4)}))}function bkap_price_range_data(){var price_range_row_data="",validate_field="",attribute_count=0;return jQuery("tr#bkap_default_price_range_row > td select[id^='attribute_']").each((function(){attribute_count++})),jQuery('#bkap_price_range_booking_table tr[id^="bkap_price_range_row_"]').each((function(i,row){var attribute_values="";attribute_count>0&&(jQuery("tr#"+this.id+" > td select[id^='attribute_']").each((function(){attribute_count++;var select_id=jQuery(this)[0].id,value=jQuery("#"+select_id+" :selected ").val();attribute_values+=value+"~~"})),attribute_values.length);var min_number=jQuery(this).find('input[id*="number_of_start_days"]').val(),max_number=jQuery(this).find('input[id*="number_of_end_days"]').val(),per_day_price=jQuery(this).find('input[id*="per_day_price"]').val(),fixed_price=jQuery(this).find('input[id*="fixed_price"]').val(),price_range_row_id_number=this.id.split("_")[4];return""==min_number?(alert("Minimum Days must be filled out"),validate_field="FAILED",!1):""==max_number?(alert("Maximum Days must be filled out"),validate_field="FAILED",!1):""!=max_number&&""!=min_number&&parseInt(max_number)<parseInt(min_number)?(alert("Minimum days should be less than the Maximum days."),validate_field="FAILED",!1):""==per_day_price&&""==fixed_price?(alert("Price must be filled out"),validate_field="FAILED",!1):void(price_range_row_data+=attribute_values+min_number+"~~"+max_number+"~~"+per_day_price+"~~"+fixed_price+"~~"+price_range_row_id_number+";;")})),"FAILED"!=validate_field&&price_range_row_data}function bkap_resource_data(){jQuery("#_bkap_resource").val();var resource_data={};jQuery("#_bkap_resource").prop("checked")?resource_data._bkap_resource=jQuery("#_bkap_resource").val():resource_data._bkap_resource="",resource_data._bkap_product_resource_lable=jQuery("#bkap_product_resource_lable").val(),resource_data._bkap_product_resource_selection=jQuery("#bkap_product_resource_selection :selected").val(),jQuery("#bkap_product_resource_max_booking").prop("checked")?resource_data._bkap_product_resource_max_booking=jQuery("#bkap_product_resource_max_booking").val():resource_data._bkap_product_resource_max_booking="",resource_data._bkap_product_resource_sorting=jQuery("#bkap_product_resource_sorting option:selected").val();var resource_ids=[],resource_costs={};return jQuery('.bkap_resource_info tr[class^="bkap_resource_row"]').each((function(i,row){var resource_id=jQuery(this).find('input[name*="resource_id"]').val(),resource_cost=jQuery(this).find('input[name*="resource_cost"]').val();""==resource_cost&&(resource_cost=0),resource_ids.push(resource_id),resource_costs[resource_id]=resource_cost})),resource_data._bkap_product_resources=resource_ids,resource_data._bkap_resource_base_costs=resource_costs,resource_data}function bkap_person_data(){jQuery("#_bkap_person").val();let person_data={};jQuery("#_bkap_person").prop("checked")?person_data.bkap_person=jQuery("#_bkap_person").val():person_data.bkap_person="",person_data.bkap_min_person=jQuery("#bkap_min_person").val(),person_data.bkap_max_person=jQuery("#bkap_max_person").val(),jQuery("#bkap_price_per_person").prop("checked")?person_data.bkap_price_per_person=jQuery("#bkap_price_per_person").val():person_data.bkap_price_per_person="",jQuery("#bkap_each_person_booking").prop("checked")?person_data.bkap_each_person_booking=jQuery("#bkap_each_person_booking").val():person_data.bkap_each_person_booking="",jQuery("#bkap_person_type").prop("checked")?person_data.bkap_person_type=jQuery("#bkap_person_type").val():person_data.bkap_person_type="";let person_ids=[],person_types={};return jQuery('.bkap_person_info tr[class^="bkap_person_row"]').each((function(i,row){let person_name=jQuery(this).find('input[name*="person_name"]').val(),person_id=jQuery(this).find('input[name*="person_id"]').val(),person_base_cost=jQuery(this).find('input[name*="person_base_cost"]').val(),person_block_cost=jQuery(this).find('input[name*="person_block_cost"]').val(),person_min=jQuery(this).find('input[name*="person_min"]').val(),person_max=jQuery(this).find('input[name*="person_max"]').val(),person_description=jQuery(this).find('input[name*="person_desc"]').val();""==person_base_cost&&(person_base_cost=0),""==person_block_cost&&(person_block_cost=0),person_ids.push(person_id),person_types[person_id]={},person_types[person_id].base_cost=person_base_cost,person_types[person_id].block_cost=person_block_cost,person_types[person_id].person_name=person_name,person_types[person_id].person_min=person_min,person_types[person_id].person_max=person_max,person_types[person_id].block_cost=person_block_cost,person_types[person_id].block_cost=person_block_cost,person_types[person_id].person_desc=person_description})),person_data.bkap_person_ids=person_ids,person_data.bkap_person_data=person_types,person_data}function bkap_save_price_by_range_settings(){var price_ranges_enable="",block_price=jQuery("input:radio[name=bkap_enable_block_pricing_type]:checked").val();if(jQuery(".bkap_price_range_booking").removeClass("bkap_disable_block_pricing"),jQuery(".bkap_fixed_block_booking").hide(),jQuery(".bkap_price_range_booking").show(),block_price.length>0&&"booking_block_price_enable"==block_price&&(price_ranges_enable=block_price),0!=bkap_settings_params.post_id){var data={ranges_enabled:price_ranges_enable,product_id:bkap_settings_params.post_id,action:"bkap_save_settings"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){}))}}function bkap_get_gcal_data(){var gcal_settings={},gcal_sync_mode=jQuery("input:radio[name=product_sync_integration_mode]:checked").val();null!=gcal_sync_mode&&(gcal_settings.gcal_sync_mode=gcal_sync_mode.trim()),gcal_settings.key_file_name=jQuery("#product_sync_key_file_name").val(),gcal_settings.service_acc_email=jQuery("#product_sync_service_acc_email_addr").val(),gcal_settings.calendar_id=jQuery("#product_sync_calendar_id").val(),gcal_settings.bkap_calendar_oauth_integration={},gcal_settings.bkap_calendar_oauth_integration.client_id=jQuery("#product_authclient_id").val(),gcal_settings.bkap_calendar_oauth_integration.client_secret=jQuery("#product_authclient_secret").val(),gcal_settings.bkap_calendar_oauth_integration.calendar_id=jQuery("#product_authcalendar_id option:selected").val(),jQuery("#enable_automated_mapping").prop("checked")&&(gcal_settings.gcal_auto_mapping=jQuery("#enable_automated_mapping").val()),jQuery("#gcal_default_variation").length>0&&(gcal_settings.default_variation=jQuery("#gcal_default_variation").val());for(var key=0;;key++){var field_name="product_ics_fee_url_"+key;if(!(jQuery("#"+field_name).length>0))break;gcal_settings["ics_feed_url_"+key]=jQuery("#"+field_name).val()}return"function"==typeof bkap_additional_integration_data&&(gcal_settings=bkap_additional_integration_data(gcal_settings)),jQuery("#enable_zoom_meeting").prop("checked")&&(gcal_settings.zoom_meeting=jQuery("#enable_zoom_meeting").val()),jQuery("#bkap_zoom_meeting_host").length>0&&(gcal_settings.zoom_meeting_host=jQuery("#bkap_zoom_meeting_host option:selected").val()),jQuery("#bkap_zoom_meeting_authentication").prop("checked")&&(gcal_settings.zoom_meeting_auth=jQuery("#bkap_zoom_meeting_authentication").val()),jQuery("#bkap_zoom_meeting_join_before_host").prop("checked")&&(gcal_settings.zoom_meeting_join_before_host=jQuery("#bkap_zoom_meeting_join_before_host").val()),jQuery("#bkap_zoom_meeting_host_video").prop("checked")&&(gcal_settings.zoom_meeting_host_video=jQuery("#bkap_zoom_meeting_host_video").val()),jQuery("#bkap_zoom_meeting_participant_video").prop("checked")&&(gcal_settings.zoom_meeting_participant_video=jQuery("#bkap_zoom_meeting_participant_video").val()),jQuery("#bkap_zoom_meeting_mute_upon_entry").prop("checked")&&(gcal_settings.zoom_meeting_mute_upon_entry=jQuery("#bkap_zoom_meeting_mute_upon_entry").val()),jQuery("#bkap_zoom_meeting_auto_recording").length>0&&(gcal_settings.zoom_meeting_auto_recording=jQuery("#bkap_zoom_meeting_auto_recording option:selected").val()),jQuery("#bkap_zoom_meeting_alternative_host").length>0&&(gcal_settings.zoom_meeting_alternative_host=jQuery("#bkap_zoom_meeting_alternative_host").val()),jQuery("#bkap_enable_fluentcrm").length>0&&(gcal_settings.bkap_fluentcrm=jQuery("#bkap_enable_fluentcrm").val()),jQuery("#bkap_fluentcrm_list").length>0&&(gcal_settings.bkap_fluentcrm_list=jQuery("#bkap_fluentcrm_list option:selected").val()),gcal_settings}function bkap_save_gcal_settings(){bkap_hide_save_icon("bkap_save_gcal_settings"),gcal_settings=bkap_get_gcal_data();var data={gcal_data:JSON.stringify(gcal_settings),product_id:bkap_settings_params.post_id,action:"bkap_save_settings"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){bkap_show_save_icon("bkap_save_gcal_settings"),jQuery("#gcal_update_notification").addClass("bkap_updated_notice"),jQuery("#gcal_update_notification").css("display","block"),jQuery("#gcal_update_notification").html(bkap_settings_params.gcal_update_msg).fadeOut(1e4)}))}function bkap_hide_save_icon(tab_class){jQuery(".ajax_img").show(),jQuery("."+tab_class).find("i").hide(),jQuery("."+tab_class).prop("disabled",!0)}function bkap_show_save_icon(tab_class){jQuery(".ajax_img").hide(),jQuery("."+tab_class).find("i").show(),jQuery("."+tab_class).prop("disabled",!1)}function bkap_save_edited_timeslot(row_number,func){bkap_settings_params.post_id;time_slot.cur_from_time=jQuery("#bkap_from_time_"+row_number).val(),time_slot.cur_to_time=jQuery("#bkap_to_time_"+row_number).val(),time_slot.cur_max_lockout=jQuery("#bkap_lockout_time_"+row_number).val(),jQuery("#bkap_global_time_"+row_number).prop("checked")&&(time_slot.cur_global_time_check="on"),time_slot.cur_product_price=jQuery("#bkap_price_time_"+row_number).val(),time_slot.cur_additional_note=jQuery("#bkap_note_time_"+row_number).val(),time_slot.product_id=bkap_settings_params.post_id,time_slot.action="bkap_update_date_time_slot",jQuery.post(bkap_settings_params.ajax_url,time_slot,(function(response){jQuery("#bkap_from_time_"+row_number).attr("readonly",!0),jQuery("#bkap_to_time_"+row_number).attr("readonly",!0),jQuery("#bkap_actions_"+row_number).html('<a href="#" id="bkap_edit_'+row_number+'" class="bkap_edit_row"><i class="fa fa-edit" aria-hidden="true"></i></a><a href="#" id="bkap_close_'+row_number+'" class="bkap_delete_row"><i class="fa fa-trash" aria-hidden="true"></i></a>'),jQuery(".bkap_date_timeslot_div").trigger("bkap_row_edited",[row_number,"edit"]),func(response)}))}function bkap_only_number(event){return event.charCode>=48&&event.charCode<=57}function bkap_validation_assign_event_handlers(_element1,_element2,errorMsg){let element1="string"==typeof _element1?jQuery(_element1):_element1,element2="string"==typeof _element2?jQuery(_element2):_element2;void 0!==element1.val()&&void 0!==element2.val()&&(element1.on("keyup change",(function(){if(""===element2.val())return;parseInt(element1.val().replace(":",""))>parseInt(element2.val().replace(":",""))?jQuery(document.body).triggerHandler("bkap_time_add_validation_text",[element1,errorMsg]):jQuery(document.body).triggerHandler("bkap_time_remove_validation_text",[element1])})),element2.on("keyup change",(function(){if(""===element1.val())return;let element1_start=parseInt(element1.val().replace(":",""));parseInt(element2.val().replace(":",""))<element1_start?jQuery(document.body).triggerHandler("bkap_time_add_validation_text",[element2,errorMsg]):jQuery(document.body).triggerHandler("bkap_time_remove_validation_text",[element2])})))}function do_bkap_save_settings_validation(){let validation={};if("duration_time"===jQuery("#bkap-booking-type").val()){let bkap_duration_start=jQuery("#bkap_duration_start").val(),bkap_duration_end=jQuery("#bkap_duration_end").val();void 0!==bkap_duration_start&&void 0!==bkap_duration_end&&(bkap_duration_start=parseInt(bkap_duration_start.replace(":","")),bkap_duration_end=parseInt(bkap_duration_end.replace(":","")),bkap_duration_start>bkap_duration_end&&(validation.bkap_duration_start={isValidated:!1,errorMessage:bkap_settings_params.validation_messages.range_type_validation}))}let is_error_from_validation=!1;return jQuery("#bkap_availability_rows tr").each((function(){let start="",end="",start_element=jQuery(this).find("div.bookings-datetime-select-from .from_time"),end_element=jQuery(this).find("div.bookings-datetime-select-to .to_time");if(start_element.is(":visible")){start_element.find("input").val()}if(end_element.is(":visible")){end_element.find("input").val()}void 0!==start&&""!==start&&void 0!==end&&""!==end&&(start=parseInt(start.replace(":","")),end=parseInt(end.replace(":","")),start>end&&(is_error_from_validation=!0))})),is_error_from_validation&&(validation.duration_range={isValidated:!1,errorMessage:bkap_settings_params.validation_messages.duration_range_validation}),is_error_from_validation=!1,jQuery('table#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').each((function(){let start=jQuery(this).find('td input[id^="bkap_from_time_"]').val(),end=jQuery(this).find('td input[id^="bkap_to_time_"]').val();void 0!==start&&""!==start&&void 0!==end&&""!==end&&(start=parseInt(start.replace(":","")),end=parseInt(end.replace(":","")),start>end&&(is_error_from_validation=!0))})),is_error_from_validation&&(validation.duration_range={isValidated:!1,errorMessage:bkap_settings_params.validation_messages.duration_range_validation}),Object.keys(validation).length>0&&(validation.isNotValidated=!0,validation.alertMessage=bkap_settings_params.validation_messages.validation_alert_message),validation}jQuery("#bkap_person_type").click((function(){0==jQuery("#bkap_person_type").prop("checked")?jQuery("#bkap_person_type_section").css("display","none"):jQuery("#bkap_person_type_section").removeAttr("style")})),jQuery(document).ready((function($){jQuery("body").hasClass("wc-wp-version-gte-55")?jQuery(".bkap_type_box").appendTo("#woocommerce-booking .hndle"):jQuery(".bkap_type_box").appendTo("#woocommerce-booking .hndle span"),jQuery("#_bkap_resource").click((function(){0==jQuery("#_bkap_resource").prop("checked")?jQuery("#resource_tab_settings").css("display","none"):jQuery("#resource_tab_settings").removeAttr("style")})),jQuery("#bkap_resource_section").on("click","button.bkap_add_resource",(function(){var loop=jQuery(".bkap_resource_row").length,add_resource_id=jQuery("select.bkap_add_resource_id").val(),add_resource_name="";if(!add_resource_id&&!(add_resource_name=prompt("Please enter resource name:")))return!1;jQuery("#bkap_resource_section").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var data={action:"bkap_add_resource",post_id:bkap_settings_params.post_id,loop:loop,add_resource_id:add_resource_id,add_resource_name:add_resource_name};return jQuery("#bkap_vendor_resource_url").length>0&&(data.bkap_resource_url=jQuery("#bkap_vendor_resource_url").val()),jQuery.post(bkap_settings_params.ajax_url,data,(function(response){response.error?alert(response.error):(jQuery(".bkap_resource_info").append(response.html),jQuery("#bkap_resource_section").unblock(),add_resource_id&&jQuery(".bkap_add_resource_id").find("option[value="+add_resource_id+"]").remove())})),!1})),jQuery(document).on("click","[id^=bkap_remove_resource]",(function(){var clicked_resource_id=jQuery(this)[0].id,resource_id=clicked_resource_id.split("_")[3];if(null==resource_id){resource_id=0;var y=confirm(bkap_resource_params.delete_resource_conf_all)}else y=confirm(bkap_resource_params.delete_resource_conf);if(1==y){var data={post_id:bkap_settings_params.post_id,delete_resource:resource_id,action:"bkap_delete_resource"};jQuery.ajax({url:bkap_settings_params.ajax_url,type:"POST",data:data,beforeSend:function(){},success:function(data,textStatus,xhr){0==resource_id?jQuery(".bkap_resource_row").remove():(bkap_rr_id="#"+clicked_resource_id,jQuery(bkap_rr_id).parent().remove()),jQuery("#resource_update_notification").addClass("bkap_updated_notice"),jQuery("#resource_update_notification").css("display","block"),jQuery("#resource_update_notification").html(bkap_resource_params.delete_resource).fadeOut(5e3)},error:function(xhr,textStatus,errorThrown){}})}})),jQuery("#bkap_person_type_section").on("click","button.bkap_add_person",(function(){let loop=jQuery(".bkap_person_row").length,person_name=prompt("Please enter person name:");if(!person_name)return!1;jQuery("#bkap_person_type_section").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var data={action:"bkap_add_person",post_id:bkap_settings_params.post_id,loop:loop,person_name:person_name};return jQuery.post(bkap_settings_params.ajax_url,data,(function(response){response.error?alert(response.error):(jQuery(".bkap_person_info").append(response.html),jQuery("#bkap_person_type_section").unblock())})),!1})),jQuery(document).on("click","[id^=bkap_remove_person]",(function(){let clicked_person_id=jQuery(this)[0].id,person_id=clicked_person_id.split("_")[3];if(null==person_id){person_id=0;var y=confirm(bkap_resource_params.delete_person_conf_all)}else y=confirm(bkap_resource_params.delete_person_conf);if(1==y){let data={post_id:bkap_settings_params.post_id,delete_person:person_id,action:"bkap_delete_person"};jQuery.ajax({url:bkap_settings_params.ajax_url,type:"POST",data:data,beforeSend:function(){},success:function(data,textStatus,xhr){0==person_id?jQuery(".person_id").remove():(bkap_rr_id="#"+clicked_person_id,jQuery(bkap_rr_id).parent().remove()),jQuery("#person_update_notification").addClass("bkap_updated_notice"),jQuery("#person_update_notification").css("display","block"),jQuery("#person_update_notification").html(bkap_resource_params.delete_person).fadeOut(5e3)},error:function(xhr,textStatus,errorThrown){}})}})),jQuery("#product-type").on("change",(function(){var product_type=jQuery("#product-type").val();-1!=jQuery.inArray(product_type,["simple","variable","subscription","variable-subscription"])?jQuery("#_bkap_resource").prop("checked")&&jQuery("#resource_tab_settings").css("display","block"):jQuery("#resource_tab_settings").css("display","none"),"grouped"==product_type?(jQuery("#bkap_gcal_msg").css("display","block"),jQuery("#bkap_gcal_fields").prop("disabled","disabled")):(jQuery("#bkap_gcal_msg").css("display","none"),jQuery("#bkap_gcal_fields").prop("disabled",""))})),$("#_bkap_person").click((function(){0==$("#_bkap_person").prop("checked")?$("#person_tab_settings").css("display","none"):$("#person_tab_settings").removeAttr("style")})),jQuery("#publish, #save-post").on("click",(function(event){var data=bkap_save_product_settings();if("error"in data)return alert(data.error),!1;jQuery.post(bkap_settings_params.ajax_url,data,(function(response){}))})),jQuery(document).on("click",".bkap_expand_all",(function(){return jQuery(".bkap_row_toggle").show(),!1})),jQuery(document).on("click",".bkap_close_all",(function(){return jQuery(".bkap_row_toggle").hide(),!1})),jQuery(document).on("click",".bkap_time_expand_all",(function(){return jQuery(".bkap_time_row_toggle").show(),!1})),jQuery(document).on("click",".bkap_time_close_all",(function(){return jQuery(".bkap_time_row_toggle").hide(),!1})),jQuery(document).on("click",".bkap_fixed_expand_all",(function(){return jQuery(".bkap_fixed_row_toggle").show(),!1})),jQuery(document).on("click",".bkap_fixed_close_all",(function(){return jQuery(".bkap_fixed_row_toggle").hide(),!1})),jQuery(document).on("click",".bkap_price_range_expand_all",(function(){return jQuery(".bkap_price_range_row_toggle").show(),!1})),jQuery(document).on("click",".bkap_price_range_close_all",(function(){return jQuery(".bkap_price_range_row_toggle").hide(),!1})),jQuery("#bkap-booking-type").change((function(){let bkap_type=jQuery(this).val(),bkap_msg="";switch(bkap_type){case"only_day":case"multidates":jQuery(".multiple_days_setup").css("display","none"),jQuery(".show-multiple-day-per-night-price-description").css("display","none"),jQuery(".bkap_date_timeslot_div").css("display","none"),jQuery(".bkap_duration_date_timeslot_div").css("display","none"),jQuery("#bkap_time_duration_availability").css("display","none"),jQuery("#block_booking_price").css("display","none"),jQuery("#block_booking").css("display","none"),jQuery("input#specific_date_checkbox").removeAttr("title"),jQuery("#purchase_wo_date_section").removeAttr("style"),bkap_add_weekdays_avail(),"multidates"==bkap_type?(jQuery("#bkap_multidate_options").removeAttr("style"),bkap_msg=bkap_settings_params.multidates_text):(jQuery("#bkap_multidate_options").css("display","none"),bkap_msg=bkap_settings_params.single_day_text);break;case"multiple_days":jQuery(".show-multiple-day-per-night-price-description").html("<b><i>"+bkap_settings_params.multiple_nights_price_text+"</i></b>"),jQuery(".show-multiple-day-per-night-price-description").removeAttr("style"),jQuery("#set_weekdays").css("display","none"),jQuery(".bkap_date_timeslot_div").css("display","none"),jQuery(".bkap_duration_date_timeslot_div").css("display","none"),jQuery("#bkap_time_duration_availability").css("display","none"),jQuery("#block_booking_price").removeAttr("style"),jQuery("#block_booking").removeAttr("style"),jQuery("input#specific_date_checkbox").removeAttr("title"),jQuery(".multiple_days_setup").removeAttr("style"),jQuery("#bkap_multidate_options").css("display","none"),bkap_add_weekdays(),bkap_msg=bkap_settings_params.multiple_nights_text;break;case"date_time":case"multidates_fixedtime":jQuery("#block_booking").css("display","none"),jQuery("#block_booking_price").css("display","none"),bkap_add_weekdays_avail(),jQuery(".multiple_days_setup").css("display","none"),jQuery("#purchase_wo_date_section").removeAttr("style"),jQuery(".bkap_date_timeslot_div").removeAttr("style"),jQuery("#bkap_multidate_options").css("display","none"),append_weekdays(),jQuery("#bkap_time_duration_availability").removeAttr("style"),"multidates_fixedtime"==bkap_type?(jQuery("#bkap_multidate_options").removeAttr("style"),bkap_msg=bkap_settings_params.multidates_fixedtime_text):(jQuery("#bkap_multidate_options").css("display","none"),bkap_msg=bkap_settings_params.fixed_time_text);break;case"duration_time":jQuery("#block_booking").css("display","none"),jQuery("#block_booking_price").css("display","none"),bkap_add_weekdays_avail(),jQuery(".multiple_days_setup").css("display","none"),jQuery("#purchase_wo_date_section").removeAttr("style"),jQuery(".bkap_date_timeslot_div").css("display","none"),jQuery(".bkap_duration_date_timeslot_div").removeAttr("style"),jQuery("#bkap_time_duration_availability").removeAttr("style"),jQuery("#bkap_multidate_options").css("display","none"),bkap_add_weekdays(),bkap_msg=bkap_settings_params.duration_time_text;break;case"multidates":bkap_msg="MultiDates";break;case"multidates_fixedtime":jQuery("#block_booking").css("display","none"),jQuery("#block_booking_price").css("display","none"),jQuery("#bkap_multidate_options").removeAttr("style"),bkap_msg="MultiDatesFixed Time"}jQuery(".show-booking-day-description").removeAttr("style"),jQuery(".show-booking-day-description").html("<b><i>"+bkap_msg+"</i></b>")})),jQuery("#bkap_multidates_fixed_range").change((function(){switch(jQuery(this).val()){case"fixed":jQuery("#enable_multidate_fixed_section").removeAttr("style"),jQuery("#enable_multidate_range_section").css("display","none");break;case"range":jQuery("#enable_multidate_range_section").removeAttr("style"),jQuery("#enable_multidate_fixed_section").css("display","none")}})),jQuery("#bkap-booking-type").trigger("change"),"multiple_days"==jQuery("#bkap-booking-type").val()?(jQuery("#block_booking_price").removeAttr("style"),jQuery("#block_booking").removeAttr("style")):(jQuery("#block_booking_price").css("display","none"),jQuery("#block_booking").css("display","none")),jQuery(".bkap_dateday_selector").length>0&&jQuery(".bkap_dateday_selector").select2({allowClear:!1,width:"100%"}),jQuery(document).on("click","[id^=week_day_]",(function(){var week_id=lastChar=lock_id=weekday_id="";week_id="#"+(week_id=jQuery(this)[0].id),lastChar=week_id.slice(-1),lock_id="#weekday_lockout_"+lastChar,weekday_id="#"+week_id+"[checked]",0==jQuery(week_id).prop("checked")?(jQuery(lock_id).val(""),jQuery(lock_id).prop("disabled",!0)):jQuery(lock_id).removeAttr("disabled")})),jQuery(".bkap_box").appendTo("#woocommerce-booking .hndle span"),jQuery((function(){jQuery("#woocommerce-booking").find(".hndle").unbind("click.postboxes"),jQuery("#woocommerce-booking").on("click",".hndle",(function(event){jQuery(event.target).filter("input, option, label, select").length||jQuery("#woocommerce-booking").toggleClass("closed")}))})),0==jQuery("#specific_date_checkbox").prop("checked")&&jQuery(".specific_date").css("display","none"),jQuery("#specific_date_checkbox").click((function(){1==jQuery("#specific_date_checkbox").prop("checked")?jQuery(".specific_date").removeAttr("style"):0==jQuery("#specific_date_checkbox").prop("checked")&&jQuery(".specific_date").css("display","none")})),jQuery(".specific").on("focus","input.datepicker_start_date",(function(){var from_start_date_id=from_start_date_new_id="";from_start_date_id=jQuery(this)[0].id,from_start_date_new_id="#"+from_start_date_id,jQuery(from_start_date_new_id).datepicker({minDate:0,dateFormat:"d-m-yy"})})),jQuery(".specific").on("focus","input.datepicker_end_date",(function(){var to_end_date_id=to_end_date_new_id="";to_end_date_id=jQuery(this)[0].id,to_end_date_new_id="#"+to_end_date_id,jQuery(to_end_date_new_id).datepicker({minDate:0,dateFormat:"d-m-yy"})})),jQuery(".specific").on("focus","textarea",(function(){var multiple_dates_specific_holiday_id=multiple_dates_specific_holiday_new_id="";multiple_dates_specific_holiday_id=jQuery(this)[0].id,multiple_dates_specific_holiday_new_id="#"+multiple_dates_specific_holiday_id,multiple_dates_specific_holiday_value=jQuery(multiple_dates_specific_holiday_new_id).val();jQuery(multiple_dates_specific_holiday_new_id).datepick({minDate:new Date,dateFormat:"d-m-yyyy",multiSelect:999,monthsToShow:1,showTrigger:"#calImg",onClose:function(){append_specific_dates(multiple_dates_specific_holiday_id,multiple_dates_specific_holiday_value)}})})),jQuery(".specific").on("click","[id^=custom_check]",(function(){var spliting_custom_check_cal_id=jQuery(this)[0].id.split("_"),custom_check_cal_id_number=parseInt(spliting_custom_check_cal_id[3]);if("checkout"==spliting_custom_check_cal_id[1])jQuery("#datepicker_textbox__"+custom_check_cal_id_number).focus();else if("checkin"==spliting_custom_check_cal_id[1]){jQuery("#datepicker_textbox_"+custom_check_cal_id_number).focus()}})),jQuery(".specific").on("click",".bkap_multiple_datepicker_cal_image",(function(){var spliting_multiple_datepicker_image_id=jQuery(this)[0].id.split("_");if(5==spliting_multiple_datepicker_image_id.length)var multiple_datepicker_image_id_number=parseInt(spliting_multiple_datepicker_image_id[4]);else multiple_datepicker_image_id_number=parseInt(spliting_multiple_datepicker_image_id[3]);if("specific"==spliting_multiple_datepicker_image_id[0]){var specific_date_multidate_cal_id="#specific_dates_multidatepicker_"+multiple_datepicker_image_id_number,specific_date_multidate_cal_value=jQuery(specific_date_multidate_cal_id).val(),formats=["d.m.y","d-m-yyyy","MM d, yy"];jQuery(specific_date_multidate_cal_id).datepick({minDate:new Date,dateFormat:formats[1],multiSelect:999,monthsToShow:1,showTrigger:"#calImg",onClose:function(){append_specific_dates(specific_date_multidate_cal_id,specific_date_multidate_cal_value)}}),jQuery(specific_date_multidate_cal_id).focus()}else if("holiday"==spliting_multiple_datepicker_image_id[0]){var holiday_multidate_cal_id="#holidays_multidatepicker_"+multiple_datepicker_image_id_number;formats=["d.m.y","d-m-yyyy","MM d, yy"];jQuery(holiday_multidate_cal_id).datepick({minDate:new Date,dateFormat:formats[1],multiSelect:999,monthsToShow:1,showTrigger:"#calImg"}),jQuery(holiday_multidate_cal_id).focus()}}));var booking_type_radio=jQuery("#bkap-booking-type").val();switch(null==booking_type_radio||"date_time"!=booking_type_radio.trim()&&"duration_time"!=booking_type_radio.trim()||append_weekdays(),jQuery(".specific").on("click","[id^=bkap_close]",(function(){jQuery(".specific").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var row_number=this.id.split("_")[2],range_set=jQuery("#range_dropdown_"+row_number).val(),record_type=range_set;switch(range_set){case"custom_range":var start=jQuery("#datepicker_textbox_"+row_number).val(),end=jQuery("#datepicker_textbox__"+row_number).val();jQuery("#bkap_bookable_nonbookable_"+row_number).prop("checked")||(record_type="holiday_range");break;case"range_of_months":start=jQuery('select[id="bkap_availability_from_month_'+row_number+'"]').val(),end=jQuery('select[id="bkap_availability_to_month_'+row_number+'"]').val();jQuery("#bkap_bookable_nonbookable_"+row_number).prop("checked")||(record_type="holiday_range");break;case"specific_dates":start=jQuery("#specific_dates_multidatepicker_"+row_number).val(),end="";break;case"holidays":start=jQuery("#holidays_multidatepicker_"+row_number).val(),end=""}var data={product_id:bkap_settings_params.post_id,record_type:record_type,start:start,end:end,action:"bkap_delete_specific_range"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){jQuery(".specific").unblock(),jQuery(".added_specific_date_range_row_"+row_number).remove()}))})),jQuery(".bkap_date_timeslot_div").on("click",".bkap_switch>[id^=bkap_global_time]",(function(e){this.id.split("_")[3]==time_slot.row_number&&(time_slot.global_toggle_btn=!0)})),jQuery(".bkap_date_timeslot_div").on("click","[id^=bkap_edit]",(function(e){e.preventDefault(),e.stopPropagation(),jQuery(".bkap_actions").each((function(e){var row_no=this.id.split("_")[2];"undefined"!==row_no&&(jQuery("#bkap_actions_"+row_no).html('<a href="#" id="bkap_edit_'+row_no+'" class="bkap_edit_row"><i class="fa fa-edit" aria-hidden="true"></i></a><a href="#" id="bkap_close_'+row_no+'" class="bkap_delete_row"><i class="fa fa-trash" aria-hidden="true"></i></a>'),jQuery("#bkap_from_time_"+row_no).attr("readonly",!0),jQuery("#bkap_to_time_"+row_no).attr("readonly",!0))}));var row_number=this.id.split("_")[2],from_time_id="#bkap_from_time_"+row_number,to_time_id="#bkap_to_time_"+row_number;to_time=jQuery("#bkap_to_time_"+row_number).val(),from_time=jQuery("#bkap_from_time_"+row_number).val();jQuery("#bkap_lockout_time_"+row_number),jQuery("#bkap_price_time_"+row_number),jQuery("#bkap_global_time_"+row_number),jQuery("#bkap_note_time_"+row_number);time_slot.row_number=row_number,time_slot.from_time=from_time,time_slot.to_time=to_time,time_slot.max_lockout=jQuery("#bkap_lockout_time_"+row_number).val(),time_slot.product_price=jQuery("#bkap_price_time_"+row_number).val(),jQuery("#bkap_global_time_"+row_number).prop("checked")&&(time_slot.global_time_check="on"),time_slot.additional_note=jQuery("#bkap_note_time_"+row_number).val(),time_slot.booking_weekday=jQuery("#bkap_dateday_selector_"+row_number).val(),jQuery(from_time_id).attr("readonly",!1),jQuery(to_time_id).attr("readonly",!1),jQuery("#bkap_actions_"+row_number).html('<a href="#" id="bkap_save_timeslot_'+row_number+'" class="bkap_save_timeslot"><i class="fa fa-check" aria-hidden="true"></i></a><a href="#" id="bkap_cancel_timeslot_'+row_number+'" class="bkap_cancel_timeslot"><i class="fa fa-times" aria-hidden="true"></i></a>'),bkap_validation_assign_event_handlers(from_time_id,to_time_id,bkap_settings_params.validation_messages.weekday_timeslot_validation)})),jQuery(".bkap_date_timeslot_div").on("click","[id^=bkap_save_timeslot]",(function(e){e.preventDefault(),e.stopPropagation();let validation=do_bkap_save_settings_validation();if(validation.isNotValidated)return void alert(validation.alertMessage);let row_number=this.id.split("_")[3];jQuery("#availability_update_notification").css("display","none"),bkap_save_edited_timeslot(row_number,(function(response){jQuery("#availability_update_notification").addClass("bkap_updated_notice"),jQuery("#availability_update_notification").css("display","block"),jQuery("#availability_update_notification").html(response.message).fadeOut(1e4)}))})),jQuery(".bkap_date_timeslot_div").on("click","[id^=bkap_cancel_timeslot]",(function(e){e.preventDefault(),e.stopPropagation();var row_number=this.id.split("_")[3],from_time_id="#bkap_from_time_"+row_number,to_time_id="#bkap_to_time_"+row_number;jQuery("#bkap_lockout_time_"+row_number).val(time_slot.max_lockout),jQuery("#bkap_price_time_"+row_number).val(time_slot.product_price),jQuery("#bkap_global_time_"+row_number).val(time_slot.global_time),jQuery("#bkap_note_time_"+row_number).val(time_slot.additional_note),1==time_slot.global_toggle_btn&&jQuery("#bkap_global_time_"+row_number).trigger("click"),jQuery(from_time_id).val(time_slot.from_time).attr("readonly",!0),jQuery(to_time_id).val(time_slot.to_time).attr("readonly",!0),jQuery("#bkap_actions_"+row_number).html('<a href="#" id="bkap_edit_'+row_number+'" class="bkap_edit_row"><i class="fa fa-edit" aria-hidden="true"></i></a><a href="#" id="bkap_close_'+row_number+'" class="bkap_delete_row"><i class="fa fa-trash" aria-hidden="true"></i></a>')})),jQuery(".bkap_date_timeslot_div").on("click","[id^=bkap_close]",(function(e){if(1==confirm(bkap_settings_params.confirm_delete_timeslots)){e.preventDefault(),e.stopPropagation(),bkap_time_slots_meta_box_ajax.bkap_block();var row_number=this.id.split("_")[2],from_time_id="#bkap_from_time_"+row_number,to_time_id="#bkap_to_time_"+row_number,day=jQuery("#bkap_dateday_selector_"+row_number).val(),from_time=jQuery(from_time_id).val(),to_time=jQuery(to_time_id).val(),data={product_id:bkap_settings_params.post_id,day:day,from_time:from_time,to_time:to_time,action:"bkap_delete_date_time"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){jQuery("#bkap_date_time_row_"+row_number).remove(),jQuery(".bkap_date_timeslot_div").trigger("bkap_row_deleted",[row_number,"delete"]),bkap_time_slots_meta_box_ajax.unblock()}))}})),jQuery(".bkap_date_timeslot_div").on("click","[id^=bkap_remove_all_timeslots]",(function(){if(jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row"]').length>0){if(1==confirm(bkap_settings_params.confirm_delete_all_timeslots)){bkap_time_slots_meta_box_ajax.bkap_block();var data={product_id:bkap_settings_params.post_id,action:"bkap_delete_all_date_time"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row"]').each((function(i,row){jQuery(this).remove()})),jQuery(".bkap_date_timeslot_div").trigger("bkap_all_row_deleted"),bkap_time_slots_meta_box_ajax.unblock(),jQuery("#availability_update_notification").addClass("bkap_updated_notice"),jQuery("#availability_update_notification").css("display","block"),jQuery("#availability_update_notification").html(bkap_settings_params.success_delete_all_timeslots).fadeOut(1e4)}))}}else alert(bkap_settings_params.no_timeslots_available)})),jQuery(".bkap_add_new_range").on("click",(function(){var each_row=new Array,i=0,last_class_name="";jQuery("tr[class^='added_specific_date_range_row']").each((function(){var class_name_row=jQuery(this)[0].className;last_class_name=class_name_row;var res=class_name_row.replace("added_specific_date_range_row_","");res==class_name_row&&0==each_row.length?each_row[i]=1:each_row[i]=parseInt(res),i++})),isNaN(each_row[0])&&each_row.shift();var new_id=Math.max.apply(Math,each_row)+1,new_tr=jQuery(".added_specific_date_range_row")[0].outerHTML.replace('class="added_specific_date_range_row" style="display: none;"','class="added_specific_date_range_row_'+new_id+'"');new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=(new_tr=new_tr.replace('id="datepicker_textbox1"','id="datepicker_textbox_'+new_id+'"')).replace('id="datepicker_textbox2"','id="datepicker_textbox__'+new_id+'"')).replace('id="range_dropdown"','id="range_dropdown_'+new_id+'"')).replace('id="textareamultidate_cal1"','id="specific_dates_multidatepicker_'+new_id+'"')).replace('id="textareamultidate_cal2"','id="holidays_multidatepicker_'+new_id+'"')).replace('id="bkap_availability_from_month"','id="bkap_availability_from_month_'+new_id+'"')).replace('id="bkap_booking_availability_to_month"','id="bkap_booking_availability_to_month_'+new_id+'"')).replace('id="custom_checkin_cal"','id="custom_checkin_cal_'+new_id+'"')).replace('id="custom_checkout_cal"','id="custom_checkout_cal_'+new_id+'"')).replace('id="month_checkin_cal"','id="month_checkin_cal_'+new_id+'"')).replace('id="month_checkout_cal"','id="month_checkout_cal_'+new_id+'"')).replace('id="specific_date_multidate_cal"','id="specific_date_multidate_cal_'+new_id+'"')).replace('id="holiday_multidate_cal"','id="holiday_multidate_cal_'+new_id+'"')).replace('id="bkap_bookable_nonbookable"','id="bkap_bookable_nonbookable_'+new_id+'"')).replace('id="bkap_close"','id="bkap_close_'+new_id+'"')).replace('id="bkap_myPopup"','id="bkap_myPopup_'+new_id+'"')).replace('id="bkap_number_of_year_to_recur_custom_range"','id="bkap_number_of_year_to_recur_custom_range_'+new_id+'"')).replace('id="bkap_number_of_year_to_recur_holiday"','id="bkap_number_of_year_to_recur_holiday_'+new_id+'"')).replace('id="bkap_number_of_year_to_recur_month"','id="bkap_number_of_year_to_recur_month_'+new_id+'"')).replace('id="bkap_specific_date_lockout"','id="bkap_specific_date_lockout_'+new_id+'"')).replace('id="bkap_specific_date_price"','id="bkap_specific_date_price_'+new_id+'"'),last_class_name=last_class_name.replace(" bkap_row_toggle",""),jQuery("."+last_class_name).after(new_tr)})),jQuery(".bkap_add_new_date_time_range").on("click",(function(){var each_row_time=[],i_time=0,last_class_name_time="bkap_default_date_time_row";jQuery("tr[id^='bkap_date_time_row']").each((function(){var class_name_row_time=jQuery(this)[0].id;last_class_name_time=class_name_row_time;var res=class_name_row_time.replace("bkap_date_time_row_","");res==class_name_row_time&&0==each_row_time.length?each_row_time[i_time]=1:each_row_time[i_time]=parseInt(res),i_time++})),0==each_row_time.length&&(each_row_time[i_time]=1),isNaN(each_row_time[0])&&each_row_time.shift();var new_id_time=Math.max.apply(Math,each_row_time)+1,new_time_tr=jQuery("#bkap_default_date_time_row")[0].outerHTML.replace('id="bkap_default_date_time_row" style="display: none;"','id="bkap_date_time_row_'+new_id_time+'" class="bkap_added"');new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=new_time_tr.replace('id="bkap_dateday_selector"','id="bkap_dateday_selector_'+new_id_time+'"')).replace('id="bkap_from_time"','id="bkap_from_time_'+new_id_time+'"')).replace('id="bkap_to_time"','id="bkap_to_time_'+new_id_time+'"')).replace('id="bkap_lockout_time"','id="bkap_lockout_time_'+new_id_time+'"')).replace('id="bkap_price_time"','id="bkap_price_time_'+new_id_time+'"')).replace('id="bkap_global_time"','id="bkap_global_time_'+new_id_time+'"')).replace('id="bkap_note_time"','id="bkap_note_time_'+new_id_time+'"')).replace('id="bkap_close"','id="bkap_close_'+new_id_time+'"')).replace('id="bkap_edit"','id="bkap_edit_'+new_id_time+'"');var last_class_name_time_new="#"+last_class_name_time;jQuery("#bkap_actions_"+time_slot.row_number).html('<a href="#" id="bkap_edit_'+time_slot.row_number+'" class="bkap_edit_row"><i class="fa fa-edit" aria-hidden="true"></i></a><a href="#" id="bkap_close_'+time_slot.row_number+'" class="bkap_delete_row"><i class="fa fa-trash" aria-hidden="true"></i></a>'),jQuery(last_class_name_time_new).after(new_time_tr),bkap_validation_assign_event_handlers("#bkap_from_time_"+new_id_time,"#bkap_to_time_"+new_id_time,bkap_settings_params.validation_messages.weekday_timeslot_validation),jQuery(document).find("#bkap_dateday_selector_"+new_id_time).select2({width:"100%"})})),jQuery(".bkap_add_new_fixed_block").on("click",(function(){var each_fixed_block=new Array,i_fixed_bock=0,last_class_name_fixed_block="bkap_default_fixed_block_row";if(jQuery("tr[id^='bkap_fixed_block_row']").each((function(){var id_of_fixed_block_row=jQuery(this)[0].id;last_class_name_fixed_block=id_of_fixed_block_row;var res=id_of_fixed_block_row.replace("bkap_fixed_block_row_","");res==id_of_fixed_block_row&&0==each_fixed_block.length?each_fixed_block[i_fixed_bock]=0:each_fixed_block[i_fixed_bock]=parseInt(res),i_fixed_bock++})),0==each_fixed_block.length)var new_id_fixed_block=0;else{isNaN(each_fixed_block[0])&&each_fixed_block.shift();new_id_fixed_block=Math.max.apply(Math,each_fixed_block)+1}var new_time_tr=jQuery("#bkap_default_fixed_block_row")[0].outerHTML.replace('id="bkap_default_fixed_block_row" style="display: none;"','id="bkap_fixed_block_row_'+new_id_fixed_block+'"');new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=new_time_tr.replace('id="booking_block_name"','id="booking_block_name_'+new_id_fixed_block+'"')).replace('id="number_of_days"','id="number_of_days_'+new_id_fixed_block+'"')).replace('id="start_day"','id="start_day_'+new_id_fixed_block+'"')).replace('id="end_day"','id="end_day_'+new_id_fixed_block+'"')).replace('id="fixed_block_price"','id="fixed_block_price_'+new_id_fixed_block+'"')).replace('id="bkap_fixed_block_close"','id="bkap_fixed_block_close_'+new_id_fixed_block+'"'),jQuery("#"+last_class_name_fixed_block).after(new_time_tr)})),jQuery(".bkap_remove_all_fixed_blocks").on("click",(function(){var y=confirm(bkap_block_pricing_params.confirm_delete_all_fixed_blocks),available_fixed_block_row=jQuery('#bkap_fixed_block_booking_table tr[id^="bkap_fixed_block_row_"]').length;if(1==y&&available_fixed_block_row>0){var data={post_id:bkap_settings_params.post_id,action:"bkap_delete_all_blocks"};jQuery.ajax({url:bkap_settings_params.ajax_url,type:"POST",data:data,beforeSend:function(){},success:function(data,textStatus,xhr){jQuery('#bkap_fixed_block_booking_table tr[id^="bkap_fixed_block_row_"]').each((function(i,row){jQuery(this).remove()})),jQuery("#block_pricing_update_notification").addClass("bkap_updated_notice"),jQuery("#block_pricing_update_notification").css("display","block"),jQuery("#block_pricing_update_notification").html(bkap_block_pricing_params.delete_all_fixed_blocks).fadeOut(1e4)},error:function(xhr,textStatus,errorThrown){}})}})),jQuery("#bkap_fixed_block_booking_table").on("click","[id^=bkap_fixed_block_close]",(function(){var y=confirm(bkap_block_pricing_params.confirm_delete_fixed_block),row_number=this.id.split("_")[4];jQuery("#booking_block_name_"+row_number).val(),jQuery("#number_of_days_"+row_number).val(),jQuery("#start_day_"+row_number).val(),jQuery("#end_day_"+row_number).val(),jQuery("#fixed_block_price_"+row_number).val();if(1==y){var data={post_id:bkap_settings_params.post_id,fixed_block_key:row_number,action:"bkap_delete_block"};jQuery.ajax({url:bkap_settings_params.ajax_url,type:"POST",data:data,beforeSend:function(){},success:function(data,textStatus,xhr){jQuery("#bkap_fixed_block_row_"+row_number).remove(),jQuery("#block_pricing_update_notification").addClass("bkap_updated_notice"),jQuery("#block_pricing_update_notification").css("display","block"),jQuery("#block_pricing_update_notification").html(bkap_block_pricing_params.delete_fixed_block).fadeOut(1e4)},error:function(xhr,textStatus,errorThrown){}})}})),jQuery(".bkap_remove_all_price_ranges").on("click",(function(){var y=confirm(bkap_block_pricing_params.confirm_delete_all_price_ranges),available_price_range_row=jQuery('#bkap_price_range_booking_table tr[id^="bkap_price_range_row_"]').length;if(1==y&&available_price_range_row>0){var data={post_id:bkap_settings_params.post_id,action:"bkap_delete_all_ranges"};jQuery.ajax({url:bkap_settings_params.ajax_url,type:"POST",data:data,beforeSend:function(){},success:function(data,textStatus,xhr){jQuery('#bkap_price_range_booking_table tr[id^="bkap_price_range_row_"]').each((function(i,row){jQuery(this).remove()})),jQuery("#block_pricing_update_notification").addClass("bkap_updated_notice"),jQuery("#block_pricing_update_notification").css("display","block"),jQuery("#block_pricing_update_notification").html(bkap_block_pricing_params.delete_all_price_ranges).fadeOut(1e4)},error:function(xhr,textStatus,errorThrown){}})}})),jQuery("#bkap_price_range_booking_table").on("click","[id^=bkap_price_range_close]",(function(){if(1==confirm(bkap_block_pricing_params.confirm_delete_price_range)){var row_number=this.id.split("_")[4],data={post_id:bkap_settings_params.post_id,price_range_key:row_number,action:"bkap_delete_range"};jQuery.ajax({url:bkap_settings_params.ajax_url,type:"POST",data:data,beforeSend:function(){},success:function(data,textStatus,xhr){jQuery("#bkap_price_range_row_"+row_number).remove(),jQuery("#block_pricing_update_notification").addClass("bkap_updated_notice"),jQuery("#block_pricing_update_notification").css("display","block"),jQuery("#block_pricing_update_notification").html(bkap_block_pricing_params.delete_price_range).fadeOut(1e4)},error:function(xhr,textStatus,errorThrown){}})}})),jQuery(document).on("click",".bkap_clear_block_pricing_selection",(function(){if(jQuery('[name="bkap_enable_block_pricing_type"]').removeAttr("checked"),jQuery('[name="bkap_enable_block_pricing_type"]').removeAttr("checked"),jQuery(".bkap_fixed_block_booking").addClass("bkap_disable_block_pricing"),jQuery(".bkap_price_range_booking").addClass("bkap_disable_block_pricing"),0!=bkap_settings_params.post_id){var data={product_id:bkap_settings_params.post_id,action:"bkap_block_pricing_options"};jQuery.post(bkap_settings_params.ajax_url,data,(function(response){}))}return!1})),jQuery(".bkap_add_new_price_range").on("click",(function(){var attribute_count=0;jQuery("tr#bkap_default_price_range_row > td select[id^='attribute_']").each((function(){attribute_count++}));var each_price_range=new Array,i_price_range=0,last_class_name_price_range="bkap_default_price_range_row";if(jQuery("tr[id^='bkap_price_range_row']").each((function(){var id_of_price_range_row=jQuery(this)[0].id;last_class_name_price_range=id_of_price_range_row;var res=id_of_price_range_row.replace("bkap_price_range_row_","");res==id_of_price_range_row&&0==each_price_range.length?each_price_range[i_price_range]=0:each_price_range[i_price_range]=parseInt(res),i_price_range++})),0==each_price_range.length)var new_id_price_range=0;else{isNaN(each_price_range[0])&&each_price_range.shift();new_id_price_range=Math.max.apply(Math,each_price_range)+1}var new_time_tr=jQuery("#bkap_default_price_range_row")[0].outerHTML.replace('id="bkap_default_price_range_row" style="display: none;"','id="bkap_price_range_row_'+new_id_price_range+'"');if(attribute_count>0)for(i=1;i<=attribute_count;i++)new_time_tr=new_time_tr.replace('id="attribute_'+i+'" value=""','id="attribute_'+i+"_"+new_id_price_range+'"');new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=(new_time_tr=new_time_tr.replace('id="number_of_start_days"','id="number_of_start_days_'+new_id_price_range+'"')).replace('id="number_of_end_days"','id="number_of_end_days_'+new_id_price_range+'"')).replace('id="per_day_price"','id="per_day_price_'+new_id_price_range+'"')).replace('id="end_day"','id="end_day_'+new_id_price_range+'"')).replace('id="fixed_price"','id="fixed_price_'+new_id_price_range+'"')).replace('id="bkap_price_range_close"','id="bkap_price_range_close_'+new_id_price_range+'"'),jQuery("#"+last_class_name_price_range).after(new_time_tr)})),jQuery(".specific").on("change","select[id^=range_dropdown]",(function(){var select_element_id=jQuery(this)[0].id,id="."+jQuery("#"+select_element_id).closest("tr").prop("class");jQuery(id);switch(this.value){case"specific_dates":jQuery(".added_specific_date_range_row");jQuery(id).find(".date_selection_textbox1").css("display","none"),jQuery(id).find(".date_selection_textbox2").css("display","none"),jQuery(id).find(".date_selection_textbox3").removeAttr("style"),jQuery(id).find(".date_selection_textbox4").css("display","none"),jQuery(id).find(".date_selection_textbox5").css("display","none"),jQuery(id).find(".date_selection_textbox6").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_1").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_2").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_3").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_4").removeAttr("style"),jQuery(id).find("input[name='bkap_bookable_nonbookable']").prop("checked",!0);break;case"holidays":jQuery(".added_specific_date_range_row");jQuery(id).find(".date_selection_textbox1").css("display","none"),jQuery(id).find(".date_selection_textbox2").css("display","none"),jQuery(id).find(".date_selection_textbox3").css("display","none"),jQuery(id).find(".date_selection_textbox4").css("display","none"),jQuery(id).find(".date_selection_textbox6").removeAttr("style"),jQuery(id).find(".date_selection_textbox5").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_1").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_2").removeAttr("style"),jQuery(id).find(".bkap_lockout_column_data_3").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_4").css("display","none"),jQuery(id).find("input[name='bkap_bookable_nonbookable']").prop("checked",!1);break;case"custom_range":jQuery(".added_specific_date_range_row");jQuery(id).find(".date_selection_textbox1").removeAttr("style"),jQuery(id).find(".date_selection_textbox2").removeAttr("style"),jQuery(id).find(".date_selection_textbox3").css("display","none"),jQuery(id).find(".date_selection_textbox4").css("display","none"),jQuery(id).find(".date_selection_textbox5").css("display","none"),jQuery(id).find(".date_selection_textbox6").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_1").removeAttr("style"),jQuery(id).find(".bkap_lockout_column_data_2").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_3").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_4").css("display","none");break;case"range_of_months":jQuery(".added_specific_date_range_row");jQuery(id).find(".date_selection_textbox1").css("display","none"),jQuery(id).find(".date_selection_textbox2").css("display","none"),jQuery(id).find(".date_selection_textbox3").css("display","none"),jQuery(id).find(".date_selection_textbox4").removeAttr("style"),jQuery(id).find(".date_selection_textbox5").removeAttr("style"),jQuery(id).find(".date_selection_textbox6").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_1").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_2").css("display","none"),jQuery(id).find(".bkap_lockout_column_data_3").removeAttr("style"),jQuery(id).find(".bkap_lockout_column_data_4").css("display","none")}})),jQuery(document).on("click","[id^=booking_weekday]",(function(){var week_id=lastChar=lock_id=weekday_id="";week_id="#"+(week_id=jQuery(this)[0].id),lastChar=week_id.slice(-1),lock_id="#weekday_lockout_"+lastChar,0==jQuery(week_id).prop("checked")?jQuery(lock_id).prop("disabled",!0):jQuery(lock_id).prop("disabled",!1)})),jQuery(document).on("click","#bkap_collapse",(function(){-1==jQuery(".tstab-tabs-nav").attr("style").search("width: 6%")?(jQuery(".bkap_tab").css("font-size","0"),jQuery(".tstab-tabs.vertical.top-left > ul").css("width","6%"),jQuery("span.dashicons-admin-collapse").css("transform","rotate(180deg)"),jQuery(".bkap_tab .fa").css("font-size","12px"),jQuery("#bkap_collapse").css("font-size","0")):(jQuery(".tstab-tabs.vertical.top-left > ul").css("width","20%"),jQuery("span.dashicons-admin-collapse").css("transform",""),jQuery(".bkap_tab").css("font-size","12px"),jQuery("#bkap_collapse").css("font-size","12px"))})),jQuery("#bkap_date_timeslot_table").on("focus","[id^=bkap_note_time]",(function(){week_id=jQuery(this)[0].id;var textarea=document.getElementById(week_id);textarea.oninput=function(){textarea.style.height="",textarea.style.height=Math.min(textarea.scrollHeight,300)+"px"}})),jQuery(".specific").on("click","[id^=bkap_bookable_nonbookable]",(function(){var id=this.id,row_number=id.lastIndexOf("_");row_number=id.substring(row_number+1);var record_type=jQuery("#range_dropdown_"+row_number).val(),popup_id="bkap_myPopup_"+row_number,popup=document.getElementById(popup_id);("holidays"==record_type&&(jQuery(popup).text("You can't set Holiday Dates as Bookable."),jQuery(popup).addClass("bkap_show"),setTimeout((function(){jQuery("#"+id).prop("checked",!1)}),500),setTimeout((function(){jQuery(popup).removeClass("bkap_show"),jQuery(popup).text("")}),4e3)),"specific_dates"==record_type)&&(!1===jQuery("#"+id).prop("checked")&&(jQuery(popup).text("All the selected Specific Dates will be considered as Holiday Dates if the bookable is switched to OFF"),jQuery(popup).addClass("bkap_show"),setTimeout((function(){jQuery(popup).removeClass("bkap_show"),jQuery(popup).text("")}),4e3)))})),jQuery("#booking_enable_date").change((function(){if(this.checked&&"simple"===jQuery("#product-type").val()&&""===jQuery("#_regular_price").val()&&""===jQuery("#_sale_price").val()){jQuery("#enable_booking_options_section").after('<div class="booking_options-flex-child" id="bkap_price_message"><p class="show-bkap-price-message"><strong><i>Please note that Booking fields will not be displayed on front end until Price is added for the product</i></strong></p></div>')}else jQuery("#bkap_price_message").length>0&&jQuery("#bkap_price_message").remove()})),jQuery(".bkap_export_booking_link").click((function(){return jQuery("#bkap_product_status_txt").select(),document.execCommand("copy"),jQuery("#bkap_myPopup").text("Settings are copied!"),jQuery("#bkap_myPopup").addClass("bkap_show"),setTimeout((function(){jQuery("#bkap_myPopup").removeClass("bkap_show"),jQuery("#bkap_myPopup").text("")}),2e3),!1})),jQuery("#product_sync_integration_mode:checked").val()){case"oauth":jQuery(".bkap_directly_mode").css("display","none");break;case"directly":jQuery(".bkap_oauth_mode").css("display","none");break;default:jQuery(".bkap_directly_mode").css("display","none"),jQuery(".bkap_oauth_mode").css("display","none")}jQuery("#enable_automated_mapping").length>0&&("on"==jQuery("#enable_automated_mapping:checked").val()?jQuery("#gcal_default_variation").prop("disabled",!1):jQuery("#gcal_default_variation").prop("disabled",!0));jQuery("input[type=radio][id=product_sync_integration_mode]").change((function(){switch(jQuery(this).val()){case"oauth":jQuery(".bkap_directly_mode").css("display","none"),jQuery(".bkap_oauth_mode").removeAttr("style");break;case"directly":jQuery(".bkap_directly_mode").removeAttr("style"),jQuery(".bkap_oauth_mode").css("display","none");break;default:jQuery(".bkap_directly_mode").css("display","none"),jQuery(".bkap_oauth_mode").css("display","none")}})),jQuery("#bkap_copy_redirect_uri").on("click",(function(){jQuery(".bkap-auth-redirect-uri").select(),document.execCommand("copy"),jQuery("#bkap_redirect_uri_copied").html("<b>Copied!</b>"),jQuery("#bkap_redirect_uri_copied").show(),setTimeout((function(){jQuery("#bkap_redirect_uri_copied").hide(),jQuery("#bkap_redirect_uri_copied").html("")}),4e3)})),jQuery("#bkap_zoom_meeting_alternative_host").length>0&&jQuery("#bkap_zoom_meeting_alternative_host").select2({allowClear:!1,placeholder:"Select alternative host",width:"100%"}),jQuery("#bkap_can_be_cancelled").click((function(){jQuery(this).prop("checked")?jQuery("#set_duration_cancellation").hasClass("can_be_cancelled_hide")&&jQuery("#set_duration_cancellation").removeClass("can_be_cancelled_hide"):(jQuery("#set_duration_cancellation").hasClass("can_be_cancelled_hide")||jQuery("#set_duration_cancellation").addClass("can_be_cancelled_hide"),jQuery("#can_be_cancelled_until_section").hasClass("can_be_cancelled_hide")||jQuery("#can_be_cancelled_until_section").addClass("can_be_cancelled_hide"))})),jQuery("#set_duration_cancellation").click((function(){jQuery(this).hasClass("can_be_cancelled_hide")||jQuery(this).addClass("can_be_cancelled_hide"),jQuery("#can_be_cancelled_until_section").hasClass("can_be_cancelled_hide")&&jQuery("#can_be_cancelled_until_section").removeClass("can_be_cancelled_hide"),""!==jQuery("#bkap_can_be_cancelled_duration").val()&&""!==jQuery("#bkap_can_be_cancelled_period").val()||(jQuery("#bkap_can_be_cancelled_duration").val(1),jQuery("#bkap_can_be_cancelled_period").val("day"))})),jQuery("#clear_duration_cancellation").click((function(){jQuery("#bkap_can_be_cancelled_duration").val(""),jQuery("#bkap_can_be_cancelled_period").val(""),jQuery("#can_be_cancelled_until_section").hasClass("can_be_cancelled_hide")||jQuery("#can_be_cancelled_until_section").addClass("can_be_cancelled_hide"),jQuery("#set_duration_cancellation").hasClass("can_be_cancelled_hide")&&jQuery("#set_duration_cancellation").removeClass("can_be_cancelled_hide")})),jQuery(document).on("keyup change",".bkap_input_price",(function(){if(""!==$(this).val()&&"undefined"!=typeof woocommerce_admin){var regex,error,decimalRegex,checkDecimalNumbers=!1;$(this).is(".bkap_input_price")?(checkDecimalNumbers=!0,regex=new RegExp("[^-0-9%\\"+woocommerce_admin.mon_decimal_point+"]+","gi"),decimalRegex=new RegExp("[^\\"+woocommerce_admin.mon_decimal_point+"]","gi"),error="i18n_mon_decimal_error"):(checkDecimalNumbers=!0,regex=new RegExp("[^-0-9%\\"+woocommerce_admin.decimal_point+"]+","gi"),decimalRegex=new RegExp("[^\\"+woocommerce_admin.decimal_point+"]","gi"),error="i18n_decimal_error");var value=$(this).val(),newvalue=value.replace(regex,"");checkDecimalNumbers&&1<newvalue.replace(decimalRegex,"").length&&(newvalue=newvalue.replace(decimalRegex,"")),value!==newvalue?($(this).val(newvalue),jQuery(document.body).triggerHandler("bkap_time_add_validation_text",[$(this),woocommerce_admin[error]])):jQuery(document.body).triggerHandler("bkap_time_remove_validation_text",[$(this)])}}))})),jQuery(".tstab-content").wrapInner('<div class="tstab-content-inner"></div>'),jQuery(document).on("click",".tstab-tab",(function(){data_link=jQuery(this).data("link"),cur_data_link=jQuery(".tstab-tab.tstab-active").data("link"),cur_data_link!==data_link&&(jQuery(".tstab-content").removeClass("tstab-active").hide(),jQuery("#"+data_link).addClass("tstab-active").css("position","relative").fadeIn("slow"),jQuery(".tstab-tab").removeClass("tstab-active"),jQuery(this).addClass("tstab-active"))})),jQuery(document).ready((function(){jQuery(document.body).on("bkap_time_add_validation_text",(function(e,element,errorMsg){0===element.parent().find(".wc_error_tip").length&&(element.after('<div class="wc_error_tip">'+errorMsg+"</div>"),element.parent().find(".wc_error_tip").fadeIn("100"))})),jQuery(document.body).on("bkap_time_remove_validation_text",(function(e,element){element.parent().find(".wc_error_tip").fadeOut("100",(function(){jQuery(this).remove()}))})),bkap_validation_assign_event_handlers("#bkap_duration_start","#bkap_duration_end",bkap_settings_params.validation_messages.range_type_validation)}));
