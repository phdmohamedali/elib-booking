var bkap_time_slots_functions=function(jQuery){return{bkap_add_new_record:function(){var bkap_data_toolbar=jQuery(".bkap_date_timeslot_div").find(".bkap_toolbar"),bkap_time_slots=bkap_data_toolbar.attr("data-time-slots"),bkap_time_slots_parsing=JSON.parse(bkap_time_slots);if(Object.keys(bkap_time_slots_parsing).length>0){var j=bkap_data_toolbar.attr("data-bkap-total");jQuery(".bkap_date_timeslot_div").find(".bkap_added").each((function(i,row){if(jQuery(this).find('select[id^="bkap_dateday_selector_"]').val()&&jQuery(this).find('input[id^="bkap_from_time_"]').val())for(var bkap_days in jQuery(this).find('select[id^="bkap_dateday_selector_"]').val())j++,bkap_time_slots_parsing=bkap_time_slots_functions.bkap_record_change(j,bkap_time_slots_parsing,bkap_days,this)})),bkap_data_toolbar.attr("data-time-slots",JSON.stringify(bkap_time_slots_parsing))}},bkap_add_row_updated_class:function(e){jQuery(this).closest("tr").addClass("bkap_row_updated")},bkap_update_row:function(){var bkap_data_toolbar=jQuery(".bkap_date_timeslot_div").find(".bkap_toolbar"),bkap_time_slots=bkap_data_toolbar.attr("data-time-slots"),bkap_time_slots_parsing=JSON.parse(bkap_time_slots);if(Object.keys(bkap_time_slots_parsing).length>0){var id="",j="";jQuery(".bkap_date_timeslot_div").find(".bkap_row_updated").each((function(i,row){if(id=jQuery(this).attr("id"),j=id.replace("bkap_date_time_row_",""),jQuery(this).find('select[id^="bkap_dateday_selector_"]').val()&&jQuery(this).find('input[id^="bkap_from_time_"]').val())for(var bkap_days in jQuery(this).find('select[id^="bkap_dateday_selector_"]').val())bkap_time_slots_functions.bkap_record_change(j,bkap_time_slots_parsing,bkap_days,this)})),bkap_data_toolbar.attr("data-time-slots",JSON.stringify(bkap_time_slots_parsing))}},bkap_record_change:function(j,bkap_time_slots_parsing,bkap_days,bkap_tr){bkap_time_slots_parsing[j]={},bkap_time_slots_parsing[j].day=jQuery(bkap_tr).find('select[id^="bkap_dateday_selector_"]').val()[bkap_days],bkap_time_slots_parsing[j].from_time=jQuery(bkap_tr).find('input[id^="bkap_from_time_"]').val(),bkap_time_slots_parsing[j].to_time=jQuery(bkap_tr).find('input[id^="bkap_to_time_"]').val(),bkap_time_slots_parsing[j].lockout_slot=jQuery(bkap_tr).find('input[id^="bkap_lockout_time_"]').val(),bkap_time_slots_parsing[j].slot_price=jQuery(bkap_tr).find('input[id^="bkap_price_time_"]').val();var global_check="";return jQuery(bkap_tr).find('input[id*="bkap_global_time"]').prop("checked")&&(global_check="on"),bkap_time_slots_parsing[j].global_time_check=global_check,bkap_time_slots_parsing[j].booking_notes=jQuery(bkap_tr).find('textarea[id^="bkap_note_time_"]').val(),bkap_time_slots_parsing},bkap_reload_page:function(e,bkap_id,action){var bkap_add_page_data_attribute=jQuery(".bkap_date_timeslot_div").find(".bkap_toolbar"),bkap_time_slots=(bkap_add_page_data_attribute.attr("data-page"),bkap_add_page_data_attribute.attr("data-time-slots")),bkap_time_slots_parsing=JSON.parse(bkap_time_slots);if(Object.keys(bkap_time_slots_parsing).length>0){if("delete"==action)delete bkap_time_slots_parsing[bkap_id];else{let from_time=jQuery("#bkap_date_time_row_"+bkap_id).find('input[id^="bkap_from_time_"]').val(),to_time=jQuery("#bkap_date_time_row_"+bkap_id).find('input[id^="bkap_to_time_"]').val(),lockout_slot=jQuery("#bkap_date_time_row_"+bkap_id).find('input[id^="bkap_lockout_time_"]').val(),slot_price=jQuery("#bkap_date_time_row_"+bkap_id).find('input[id^="bkap_price_time_"]').val();bkap_time_slots_parsing[bkap_id].from_time=from_time,bkap_time_slots_parsing[bkap_id].to_time=to_time,bkap_time_slots_parsing[bkap_id].lockout_slot=lockout_slot,bkap_time_slots_parsing[bkap_id].slot_price=slot_price}var bkap_upated_count=Object.keys(bkap_time_slots_parsing).length;bkap_add_page_data_attribute.attr("data-time-slots",JSON.stringify(bkap_time_slots_parsing)),bkap_time_slots_functions.bkap_update_total_number_of_record(bkap_upated_count)}},bkap_reload_page_all_timeslots_delete:function(e){var bkap_add_page_data_attribute=jQuery(".bkap_date_timeslot_div").find(".bkap_toolbar");bkap_add_page_data_attribute.attr("data-time-slots",JSON.stringify({})),bkap_add_page_data_attribute.attr("data-bkap-total",0),bkap_add_page_data_attribute.attr("data-total_pages",1),bkap_add_page_data_attribute.attr("data-page",1),bkap_time_slots_functions.bkap_update_total_number_of_record(0),jQuery(".bkap_page_selector option").each((function(){"1"!=jQuery(this).val()&&jQuery(this).remove()})),jQuery(".bkap_total_pages").html(1)},bkap_update_total_number_of_record:function(bkap_udated_count){jQuery(".bkap_display_count_num").html(bkap_udated_count)}}}(jQuery),bkap_each_time_slot_tr_height=0,bkap_time_slots_meta_box_ajax={bkap_init:function(){jQuery("li.bkap_availability a").on("click",this.bkap_initial_load),jQuery(document.body).on("change",".bkap_default",bkap_time_slots_functions.bkap_add_row_updated_class),jQuery(document.body).on("bkap_added",bkap_time_slots_functions.bkap_add_new_record),jQuery(document.body).on("bkap_row_updated",bkap_time_slots_functions.bkap_update_row),jQuery(document.body).on("bkap_row_deleted",bkap_time_slots_functions.bkap_reload_page),jQuery(document.body).on("bkap_row_edited",bkap_time_slots_functions.bkap_reload_page),jQuery(document.body).on("bkap_all_row_deleted",bkap_time_slots_functions.bkap_reload_page_all_timeslots_delete)},bkap_initial_load:function(){1===jQuery("#bkap_date_timeslot_table").find(".bkap_replace_response_data").length&&bkap_time_slots_meta_box_pagenav.bkap_go_to_page()},bkap_load_time_slots:function(bkap_page,bkap_per_page){bkap_page=bkap_page||1,bkap_per_page=bkap_per_page||bkap_time_slots_params.bkap_time_slots_per_page;var wrapper=jQuery(".bkap_replace_response_data");bkap_time_slots_meta_box_ajax.bkap_block(),jQuery.ajax({url:bkap_time_slots_params.ajax_url,data:{action:"bkap_load_time_slots",bkap_product_id:bkap_time_slots_params.bkap_product_id,bkap_page:bkap_page,bkap_per_page:bkap_per_page},type:"POST",success:function(bkap_response){(bkap_add_page_data_attribute=jQuery(".bkap_date_timeslot_div").find(".bkap_toolbar")).attr("data-page");var bkap_add_page_data_attribute,bkap_time_slots=bkap_add_page_data_attribute.attr("data-time-slots"),p=JSON.parse(bkap_time_slots),new_objct={},i=1;for(var key in p)new_objct[i]=p[key],i++;bkap_add_page_data_attribute.attr("data-time-slots",JSON.stringify(new_objct)),wrapper.empty().replaceWith(bkap_response),jQuery(".bkap_dateday_selector").length>0&&jQuery(".bkap_dateday_selector").select2({allowClear:!1,width:"100%"}),(bkap_add_page_data_attribute=jQuery(".bkap_date_timeslot_div").find(".bkap_toolbar")).attr("data-page",bkap_page),bkap_time_slots_meta_box_ajax.unblock()}})},bkap_block:function(){jQuery("#bkap-tabbed-nav").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){jQuery("#bkap-tabbed-nav").unblock()}},bkap_time_slots_meta_box_pagenav={bkap_init:function(){jQuery(document.body).on("change",".bkap_toolbar .bkap_page_selector",this.bkap_page_selector).on("click",".bkap_toolbar .bkap_next_page",this.bkap_next_page).on("click",".bkap_toolbar .bkap_prev_page",this.bkap_prev_page).on("click",".bkap_toolbar .bkap_last_page",this.bkap_last_page).on("click",".bkap_toolbar .bkap_first_page",this.bkap_first_page)},bkap_go_to_page:function(bkap_page,bkap_qty){bkap_page=bkap_page||1,bkap_time_slots_meta_box_pagenav.bkap_set_page(bkap_page)},bkap_set_page:function(bkap_page){jQuery(".bkap_toolbar .bkap_page_selector").val(bkap_page).first().change()},bkap_page_selector:function(){wrapper=jQuery(".bkap_date_timeslot_div").find(".bkap_toolbar");var bkap_selected=parseInt(jQuery(this).val(),10);jQuery(".bkap_toolbar .bkap_page_selector").val(bkap_selected),jQuery(".bkap_date_timeslot_div").trigger("bkap_added"),jQuery(".bkap_date_timeslot_div").trigger("bkap_row_updated"),jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').each((function(i,row){bkap_each_time_slot_tr_height+=jQuery(this).height(),row.remove()})),jQuery(".bkap_replace_response_data").height(bkap_each_time_slot_tr_height/2),bkap_time_slots_meta_box_pagenav.bkap_change_classes(bkap_selected,parseInt(wrapper.attr("data-total_pages"),10)),bkap_time_slots_meta_box_ajax.bkap_load_time_slots(bkap_selected)},bkap_next_page:function(){if(bkap_time_slots_meta_box_pagenav.bkap_check_is_enabled(this)){jQuery(".bkap_date_timeslot_div").trigger("bkap_added"),jQuery(".bkap_date_timeslot_div").trigger("bkap_row_updated");var wrapper=jQuery(".bkap_date_timeslot_div").find(".bkap_toolbar"),total_pages=parseInt(wrapper.attr("data-total_pages"),10),next_page=parseInt(wrapper.attr("data-page"),10)+1,new_page=total_pages>=next_page?next_page:total_pages;jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').each((function(i,row){bkap_each_time_slot_tr_height+=jQuery(this).height(),row.remove()})),jQuery(".bkap_replace_response_data").height(bkap_each_time_slot_tr_height/2),bkap_time_slots_meta_box_pagenav.bkap_set_page(new_page)}return!1},bkap_check_is_enabled:function(current){return!jQuery(current).hasClass("disabled")},bkap_prev_page:function(){if(bkap_time_slots_meta_box_pagenav.bkap_check_is_enabled(this)){var wrapper=jQuery(".bkap_date_timeslot_div").find(".bkap_toolbar"),prev_page=parseInt(wrapper.attr("data-page"),10)-1,new_page=0<prev_page?prev_page:1;jQuery(".bkap_date_timeslot_div").trigger("bkap_added"),jQuery(".bkap_date_timeslot_div").trigger("bkap_row_updated"),jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').each((function(i,row){bkap_each_time_slot_tr_height+=jQuery(this).height(),row.remove()})),jQuery(".bkap_replace_response_data").height(bkap_each_time_slot_tr_height/2),bkap_time_slots_meta_box_pagenav.bkap_set_page(new_page)}return!1},bkap_change_classes:function(selected,total){var first_page=jQuery(".bkap_toolbar .bkap_first_page"),prev_page=jQuery(".bkap_toolbar .bkap_prev_page"),next_page=jQuery(".bkap_toolbar .bkap_next_page"),last_page=jQuery(".bkap_toolbar .bkap_last_page");1===selected?(first_page.addClass("disabled"),prev_page.addClass("disabled")):(first_page.removeClass("disabled"),prev_page.removeClass("disabled")),total===selected?(next_page.addClass("disabled"),last_page.addClass("disabled")):(next_page.removeClass("disabled"),last_page.removeClass("disabled"))},bkap_last_page:function(){if(bkap_time_slots_meta_box_pagenav.bkap_check_is_enabled(this)){var last_page=jQuery(".bkap_date_timeslot_div").find(".bkap_toolbar").attr("data-total_pages");jQuery(".bkap_date_timeslot_div").trigger("bkap_added"),jQuery(".bkap_date_timeslot_div").trigger("bkap_row_updated"),jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').each((function(i,row){bkap_each_time_slot_tr_height+=jQuery(this).height(),row.remove()})),jQuery(".bkap_replace_response_data").height(bkap_each_time_slot_tr_height/2),bkap_time_slots_meta_box_pagenav.bkap_set_page(last_page)}return!1},bkap_first_page:function(){return bkap_time_slots_meta_box_pagenav.bkap_check_is_enabled(this)&&(jQuery(".bkap_date_timeslot_div").trigger("bkap_added"),jQuery(".bkap_date_timeslot_div").trigger("bkap_row_updated"),jQuery('#bkap_date_timeslot_table tr[id^="bkap_date_time_row_"]').each((function(i,row){bkap_each_time_slot_tr_height+=jQuery(this).height(),row.remove()})),jQuery(".bkap_replace_response_data").height(bkap_each_time_slot_tr_height/2),bkap_time_slots_meta_box_pagenav.bkap_set_page(1)),!1}};bkap_time_slots_meta_box_ajax.bkap_init(),bkap_time_slots_meta_box_pagenav.bkap_init();
