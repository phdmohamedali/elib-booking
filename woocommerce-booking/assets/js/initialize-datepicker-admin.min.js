function ad(dateObj,numDays){return dateObj.setDate(dateObj.getDate()+numDays)}function gd(date1,date2,interval){date1=new Date(date1).getTime();var timediff=(date2="now"==date2?(new Date).getTime():new Date(date2).getTime())-date1;if(isNaN(timediff))return NaN;switch(interval){case"years":return date2.getFullYear()-date1.getFullYear();case"months":return 12*date2.getFullYear()+date2.getMonth()-(12*date1.getFullYear()+date1.getMonth());case"weeks":return Math.floor(timediff/6048e5);case"days":return Math.floor(timediff/864e5);case"hours":return Math.floor(timediff/36e5);case"minutes":return Math.floor(timediff/6e4);case"seconds":return Math.floor(timediff/1e3);default:return}}function nd(date){var m=date.getMonth(),d=date.getDate(),y=date.getFullYear(),dt=new Date,order_item_id=(dt.getMonth(),dt.getDate(),dt.getFullYear(),jQuery("#order_item_ids").val()),holidayDates=JSON.parse("["+jQuery("#wapbk_admin_booking_holidays_"+order_item_id).val()+"]"),globalHolidays=JSON.parse("["+jQuery("#wapbk_admin_booking_global_holidays_"+order_item_id).val()+"]");for(iii=0;iii<globalHolidays.length;iii++)if(-1!=jQuery.inArray(d+"-"+(m+1)+"-"+y,globalHolidays))return[!1,"","Holiday"];for(ii=0;ii<holidayDates.length;ii++)if(-1!=jQuery.inArray(d+"-"+(m+1)+"-"+y,holidayDates))return[!1,"","Holiday"];return[!0]}function sp(date){var m=date.getMonth(),d=date.getDate(),y=date.getFullYear(),dt=new Date,order_item_id=(dt.getMonth(),dt.getDate(),dt.getFullYear(),jQuery("#order_item_ids").val()),deliveryDates=JSON.parse("["+jQuery("#wapbk_admin_booking_dates_"+order_item_id).val()+"]");for(ii=0;ii<deliveryDates.length;ii++)if(-1!=jQuery.inArray(d+"-"+(m+1)+"-"+y,deliveryDates))return[!0];return[!1]}function fixed_range(date){var order_item_id=jQuery("#order_item_ids").val(),dt=(date.getMonth(),date.getDate(),date.getFullYear(),new Date),FixedRangeDates=(dt.getMonth(),dt.getDate(),dt.getFullYear(),JSON.parse("["+jQuery("#wapbk_admin_fixed_range_"+order_item_id).val()+"]")),in_range=!1;for(i=0;i<FixedRangeDates.length;){var j=i,range_start=FixedRangeDates[j],range_end=FixedRangeDates[j+1],split_start_1=range_start.split("-"),split_end_1=range_end.split("-"),start_date1=new Date(split_start_1[1]+"/"+split_start_1[0]+"/"+split_start_1[2]);start_new=start_date1.getMonth()+1+"/"+start_date1.getDate()+"/"+start_date1.getFullYear();var end_date1=new Date(split_end_1[1]+"/"+split_end_1[0]+"/"+split_end_1[2]);end_new=end_date1.getMonth()+1+"/"+end_date1.getDate()+"/"+end_date1.getFullYear();var start_range=new Date(start_new),end_date=new Date(end_new),end_range=new Date(end_date.getTime());end_range.setDate(end_range.getDate()+1),date>=start_range&&date<end_range&&(in_range=!0),i+=2}return 1==in_range}function avd(date){var order_item_id=jQuery("#order_item_ids").val();if(jQuery("#wapbk_admin_fixed_range_"+order_item_id).length>0){var split_date=jQuery("#wapbk_admin_minimumOrderDays_"+order_item_id).val().split("-"),start_day=new Date(split_date[1]+"/"+split_date[0]+"/"+split_date[2]),split_date_end=(end_date=jQuery("#wapbk_admin_number_of_dates_"+order_item_id).val()).split("-"),end_day=new Date(split_date_end[1]+"/"+split_date_end[0]+"/"+split_date_end[2]);return isNaN(start_day)&&(start_day=new Date),start=start_day.getMonth()+1+"/"+start_day.getDate()+"/"+start_day.getFullYear(),end=end_day.getMonth()+1+"/"+end_day.getDate()+"/"+end_day.getFullYear(),{minDate:new Date(start),maxDate:new Date(end)}}split_date=jQuery("#wapbk_admin_minimumOrderDays_"+order_item_id).val().split("-");var delay_days=new Date(split_date[1]+"/"+split_date[0]+"/"+split_date[2]),noOfDaysToFind=parseInt(jQuery("#wapbk_admin_number_of_dates_"+order_item_id).val()),recurring_days=jQuery("#wapbk_admin_recurringDays_"+order_item_id).val(),specific_dates=jQuery("#wapbk_admin_specificDates_"+order_item_id).val();isNaN(delay_days)&&(delay_days=new Date),isNaN(noOfDaysToFind)&&(noOfDaysToFind=30);var t_year=(date=new Date).getFullYear(),t_month=date.getMonth()+1;date.getDate(),new Date(t_year,t_month,0).getDate();start=delay_days.getMonth()+1+"/"+delay_days.getDate()+"/"+delay_days.getFullYear();delay_days.getMonth();var end_date=new Date(ad(delay_days,noOfDaysToFind));end=end_date.getMonth()+1+"/"+end_date.getDate()+"/"+end_date.getFullYear();var specific_max_date=start,dt=(date.getMonth(),date.getDate(),date.getFullYear(),new Date),deliveryDates=(dt.getMonth(),dt.getDate(),dt.getFullYear(),JSON.parse("["+jQuery("#wapbk_admin_booking_dates_"+order_item_id).val()+"]"));for(ii=0;ii<deliveryDates.length;ii++){var split=deliveryDates[ii].split("-"),specific_date=split[1]+"/"+split[0]+"/"+split[2],diff=gd(specific_max_date,specific_date,"days");diff>=0&&(specific_max_date=specific_date)}for(var is_holiday,loopCounter=gd(start,end,"days"),i=1;i<=loopCounter;i++){var l_start=new Date(start),l_end=new Date(end);l_end;var new_date=new Date(ad(l_start,i)),day="";if(""==jQuery("#wapbk_admin_multiple_day_booking_"+order_item_id).val())day="booking_weekday_"+new_date.getDay(),day_check=jQuery("#wapbk_admin_"+(day+"_"+order_item_id)).val(),is_specific=sp(new_date);else is_specific="true",day_check="on";is_holiday=nd(new_date),"false"!=is_specific&&"true"==is_holiday||"on"==day_check&&"true"==is_holiday||(l_end=new Date(ad(l_end,1)),end=l_end.getMonth()+1+"/"+l_end.getDate()+"/"+l_end.getFullYear(),"on"!=recurring_days&&"on"==specific_dates?(diff=gd(l_end,specific_max_date,"days"))>=0&&(loopCounter=gd(start,end,"days")):loopCounter=gd(start,end,"days"))}return{minDate:new Date(start),maxDate:l_end}}
